<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Curso R: Programação em R (Nível Intermediário)</title>

  <meta property="description" itemprop="description" content="Esse módulo terá o objetivo de detalhar o ambiente R, caracterizando melhor a sua linguagem, aprofundando **manipulações de objetos**, **cópias de objetos**, bem como **ambientes**. Falaremos sobre a criação de gráficos e **documentações em R**. Complementaremos também, sobre assuntos mais aprofundados como **programação funcional**, **programação orientada a objetos**, **metaprogramação** e uma introdução sobre **desenvolvimento de pacotes**. Por fim, ainda apresenderemos a desenvolver **gráficos**, e **banco de dados**."/>

  <link rel="icon" type="image/png" href="images/favicon.png"/>


  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Curso R: Programação em R (Nível Intermediário)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Esse módulo terá o objetivo de detalhar o ambiente R, caracterizando melhor a sua linguagem, aprofundando **manipulações de objetos**, **cópias de objetos**, bem como **ambientes**. Falaremos sobre a criação de gráficos e **documentações em R**. Complementaremos também, sobre assuntos mais aprofundados como **programação funcional**, **programação orientada a objetos**, **metaprogramação** e uma introdução sobre **desenvolvimento de pacotes**. Por fim, ainda apresenderemos a desenvolver **gráficos**, e **banco de dados**."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Curso R"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Curso R: Programação em R (Nível Intermediário)"/>
  <meta property="twitter:description" content="Esse módulo terá o objetivo de detalhar o ambiente R, caracterizando melhor a sua linguagem, aprofundando **manipulações de objetos**, **cópias de objetos**, bem como **ambientes**. Falaremos sobre a criação de gráficos e **documentações em R**. Complementaremos também, sobre assuntos mais aprofundados como **programação funcional**, **programação orientada a objetos**, **metaprogramação** e uma introdução sobre **desenvolvimento de pacotes**. Por fim, ainda apresenderemos a desenvolver **gráficos**, e **banco de dados**."/>
  <meta property="twitter:site" content="@bendeivide"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Statistical models in S;citation_publication_date=1993;citation_publisher=Chapman &amp; Hall;citation_author=John M. Chambers;citation_author=Trevor J. Hastie"/>
  <meta name="citation_reference" content="citation_title=Advanced R;citation_publication_date=2019;citation_publisher=Chapman; Hall/CRC;citation_author=Hadley Wickham"/>
  <meta name="citation_reference" content="citation_title=Extending R;citation_publication_date=2016;citation_publisher=Chapman; Hall/CRC;citation_author=John M. Chambers"/>
  <meta name="citation_reference" content="citation_title=Software for data analysis: Programming with R;citation_publication_date=2008;citation_publisher=Springer;citation_author=John M. Chambers"/>
  <meta name="citation_reference" content="citation_title=Statistical methods in S;citation_publication_date=1991;citation_publisher=Chapman &amp; Hall;citation_author=John M. Chambers;citation_author=Trevor J. Hastie"/>
  <meta name="citation_reference" content="citation_title=Advanced R;citation_publication_date=2019;citation_publisher=Chapman; Hall/CRC;citation_author=Hadley Wickham"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","bibliography","link-citations","site"]}},"value":[{"type":"character","attributes":{},"value":["Programação em R (Nível Intermediário)"]},{"type":"character","attributes":{},"value":["Esse módulo terá o objetivo de detalhar o ambiente R, caracterizando melhor a sua linguagem, aprofundando **manipulações de objetos**, **cópias de objetos**, bem como **ambientes**. Falaremos sobre a criação de gráficos e **documentações em R**. Complementaremos também, sobre assuntos mais aprofundados como **programação funcional**, **programação orientada a objetos**, **metaprogramação** e uma introdução sobre **desenvolvimento de pacotes**. Por fim, ainda apresenderemos a desenvolver **gráficos**, e **banco de dados**.\n"]},{"type":"character","attributes":{},"value":["biblio.bib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["distill::distill_website"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-183980834-3"></script>
  <script type="text/javascript" cookie-consent="tracking">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-183980834-3');
  </script>
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Programação em R (Nível Intermediário)","description":"Esse módulo terá o objetivo de detalhar o ambiente R, caracterizando melhor a sua linguagem, aprofundando **manipulações de objetos**, **cópias de objetos**, bem como **ambientes**. Falaremos sobre a criação de gráficos e **documentações em R**. Complementaremos também, sobre assuntos mais aprofundados como **programação funcional**, **programação orientada a objetos**, **metaprogramação** e uma introdução sobre **desenvolvimento de pacotes**. Por fim, ainda apresenderemos a desenvolver **gráficos**, e **banco de dados**.","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://www.r-project.org/">
<img src="images/logo2.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Curso R</a>
<a href="index.html" aria-label="Home">
<i class="fas fa-home" aria-hidden="true"></i>
</a>
<a href="about.html">Autor</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Material
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="nbasico.html">Basico</a>
<a href="nintermediario.html">Intermediario</a>
<span class="nav-dropdown-header">Avancado</span>
</div>
</div>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="https://www.facebook.com/bendeivide/">
<i class="fab fa-facebook" aria-hidden="true"></i>
</a>
<a href="https://www.instagram.com/bendeivide/">
<i class="fab fa-instagram" aria-hidden="true"></i>
</a>
<a href="https://benalana.blogspot.com/">
<i class="fab fa-blogger" aria-hidden="true"></i>
</a>
<a href="http://youtube.com/bendeivide/">
<i class="fab fa-youtube-square" aria-hidden="true"></i>
</a>
<a href="http://twitter.com/bendeivide/">
<i class="fab fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/bendeivide/">
<i class="fab fa-linkedin" aria-hidden="true"></i>
</a>
<a href="https://github.com/bendeivide/cursor/">
<i class="fa fa-github fa-lg" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Programação em R (Nível Intermediário)</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Esse módulo terá o objetivo de detalhar o ambiente R, caracterizando melhor a sua linguagem, aprofundando <strong>manipulações de objetos</strong>, <strong>cópias de objetos</strong>, bem como <strong>ambientes</strong>. Falaremos sobre a criação de gráficos e <strong>documentações em R</strong>. Complementaremos também, sobre assuntos mais aprofundados como <strong>programação funcional</strong>, <strong>programação orientada a objetos</strong>, <strong>metaprogramação</strong> e uma introdução sobre <strong>desenvolvimento de pacotes</strong>. Por fim, ainda apresenderemos a desenvolver <strong>gráficos</strong>, e <strong>banco de dados</strong>.</p></p>
</div>


<div class="d-article">
<h1 id="sumário">Sumário</h1>
<ul>
<li><a href="#caracteristasR"><i class="fab fa-r-project"></i> Caracterizando melhor o ambiente R</a></li>
<li><a href="#poo"><i class="fas fa-puzzle-piece"></i> Programação orientada a objetos</a>
<ul>
<li><a href="#objetos-oo-base">Nem tudo é orientado a objetos no R</a></li>
<li><a href="#objetos-base">Objetos base</a></li>
<li><a href="#sistemas-poo">Sistemas de POO no <code>R</code></a></li>
<li><a href="#sistemaS3">Sistema S3</a>
<ul>
<li><a href="#fgenericas">Funções genéricas</a></li>
<li><a href="#UseMethod">Entendendo melhor a chamada <code>UseMethod</code></a></li>
<li><a href="#criando_fgenericas">Criando funções genéricas</a></li>
<li><a href="#classeS3">Classe e classe implícita</a></li>
<li><a href="#metodoS3">Método S3</a></li>
<li><a href="#envio-herança">Envio de método e mecanismo de herança</a> <!-- - [Estratégias para o sistema S3](#estrategiaS3) --> <!-- - [Estilos de objetos POO S3](#est_obj_poo_s3) --></li>
</ul></li>
</ul></li>
<li><a href=""><i class="fas fa-arrow-circle-left"></i> Entendendo um pouco mais sobre objetos no <code>R</code></a>
<ul>
<li>Manipulações com objetos</li>
<li>Subconjuntos</li>
<li>Cópias de objetos</li>
<li>Manipulando <em>strings</em> (caracteres)</li>
<li>Objeto <em>tibble</em></li>
<li>Objeto <em>raw</em></li>
</ul></li>
<li><a href=""><i class="far fa-image"></i> Aprofundamento sobre ambientes</a></li>
<li><a href=""><i class="fab fa-connectdevelop"></i> Programação Funcional</a>
<ul>
<li>Operadores binários</li>
<li>Sintaxe da família de Pacotes <em>Tidyverse</em></li>
<li>Evitando <em>loops</em></li>
<li>Funções recursivas <!-- Capítulo 8 - Conditions (Advanced R) --></li>
<li>Programação defensiva</li>
<li>Controle de fluxos usando paralelização</li>
</ul></li>
<li><a href=""><i class="fas fa-database"></i> Banco de dados</a></li>
<li><a href=""><i class="fas fa-chart-bar"></i> Gráficos</a></li>
<li><a href=""><i class="fas fa-folder"></i> Projetos no RStudio</a><br />
</li>
<li><a href=""><i class="fab fa-github-square"></i> Projetos R no GitHub</a></li>
<li><a href=""><i class="fas fa-box-open"></i> Introdução a desenvolvimento de pacotes</a></li>
<li><a href=""><i class="fas fa-file-alt"></i> Criação de documentações no R</a>
<ul>
<li>Documentos <em>Web</em>
<ul>
<li>Páginas estatísticas</li>
<li>Páginas dinâmicas</li>
</ul></li>
<li>Documentações de pacotes
<ul>
<li>Documentações de ajuda <em>.Rd</em></li>
<li>Página <em>Web</em> de pacotes</li>
</ul></li>
<li>Livros</li>
<li><em>Blogs</em> e <em>websites</em></li>
<li>Relatórios
<ul>
<li>Relatórios animados</li>
<li>Relatórios dinâmicos</li>
</ul></li>
<li>Demais documentos (PDF, WORD, EPUB)</li>
</ul></li>
</ul>
<h2 id="section"></h2>
<h1 id="materiais"><i class="fas fa-folder-open"></i> Materiais para este módulo</h1>
<h2 id="slidesaulas">Slides de Aulas</h2>
<ul>
<li>Aula 26: <a href="aulas/aula26.html" target="_blank">Apresentação do Curso</a></li>
<li>Aula 27: <a href="aulas/aula27.html" target="_blank">Caracterizando melhor o ambiente R</a></li>
<li>Aula 28: <a href="aulas/aula28.html" target="_blank">Introdução a POO no ambiente R</a></li>
<li>Aula 29: <a href="aulas/aula29.html" target="_blank">Tipos de objetos base</a></li>
<li>Aula 30: <a href="aulas/aula30.html" target="_blank">Sistemas de POO no R</a></li>
<li>Aula 31: <a href="aulas/aula31.html" target="_blank">Sistema S3</a></li>
<li>Aula 32: <a href="aulas/aula32.html" target="_blank">Sistema S3: Funções genéricas (POO no R)</a></li>
<li>Aula 33: <a href="aulas/aula33.html" target="_blank">Sistema S3: Chamada <em>UseMethod</em> (POO no R)</a></li>
<li>Aula 34: <a href="aulas/aula34.html" target="_blank">Sistema S3: Criando funções genéricas (POO no R)</a></li>
<li>Aula 35: <a href="aulas/aula35.html" target="_blank">Sistema S3: Classes e classes implícitas (POO no R)</a></li>
<li>Aula 36: <a href="aulas/aula36.html" target="_blank">Sistema S3: Métodos (POO no R)</a></li>
<li>Aula 37: <a href="aulas/aula37.html" target="_blank">Revisão sobre as aulas 27 a 36</a></li>
<li>Aula 38: <a href="aulas/aula37.html" target="_blank">Sistema S3: Envio (despacho) de métodos e hieranças</a> <!-- - Aula 39: [Sistema S3:  Estratégias para o sistema S3](aulas/aula38.html){target="_blank"} --> <!-- - Aula 40: [Sistema S3:  Estilos de objetos](aulas/aula39.html){target="_blank"} --></li>
</ul>
<h2 id="scripts">Scripts</h2>
<ul>
<li>Script 00:</li>
</ul>
<h2 id="shiny">Scripts via <a href="https://shiny.rstudio.com/">Shiny</a></h2>
<p><a href="https://bendeivide.shinyapps.io/Curso-R/">Curso R via Shiny</a></p>
<h1 id="apresentacao"><i class="fas fa-book"></i> Apresentação do curso</h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/tegLquZ1jsw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>O Curso <code>R</code> será todo aprensentado no formato online, sendo que as aulas terão vídeos como suporte, postados no canal <a href="http://youtube.com/bendeivide" target="_blank">Youtube/Ben Dêivide</a> divulgados ao longo do material. Os vídeos serão bem objetivos de curta duração para que usem como suporte com o material escrito. Como complemento desse material, disponibilizaremos os <a href="#scripts"><em>scripts</em></a> com os comandos utilizados em cada aula e sua versão em <a href="#shiny"><em>Shiny</em></a> para os que não quiserem realizar inicialmente a instalação do R e do RStudio, poderão utilizar uma versão <em>online</em> do material juntamente com a linguagem <code>R</code>.</p>
<h1 id="caracteristasR"><i class="fab fa-r-project"></i> Caracterizando melhor o ambiente R</h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/mrJqW8yJLx0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>Ao estudarmos o <a href="nbasico.html">módulo básico</a> do Curso R, conseguimos obter uma visão geral sobre o ambiente <code>R</code>, de modo que o aprofundamento sobre a linguagem se faz necessário, para quem deseja não apenas executar rotinas prontas, mas de fato, um contribuidor para a linguagem, como também um desenvolvedor de suas próprias funções.</p>
<p>Na Figura <a href="#fig:rworks">1</a>, apresentamos um resumo do que buscamos repassar no primeiro módulo. Agora, iremos no módulo intermediário, de fato, entender os dois princípios: Objeto e Função, para que fique claro que nem tudo no <code>R</code> é orientado a objetos, e que a rigor o <code>R</code> não é uma linguagem de programação funcional. Com essas informações, dentre outras, o programador poderá ter um maior controle sobre o desenvolvimento de suas próprias rotinas e funções.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:rworks"></span>
<img src="images/rworks2.png" alt="Relembrando como o `R` funciona." width="100%" />
<p class="caption">
Figure 1: Relembrando como o <code>R</code> funciona.
</p>
</div>
</div>
<p>Vamos inicialmente caracterizar melhor o R. Por que usamos os termos <strong>linguagem</strong>, <strong>software</strong> ou <strong>ambiente</strong> para o <code>R</code>? Na página do <code>R</code>, na seção <a href="https://www.r-project.org/about.html"><em>about</em></a> se inicia com a primeira pergunta: O que é o R? Em resposta da própria página e utilizando também como resposta a nossa indagação inicial, o “R é uma linguagem e ambiente para computação estatística e gráficos,” que ainda complementa que essa linguagem é uma implementação diferente da linguagem <code>S</code>, linguagem essa do qual inclui as principais implementações para análise estatística. Contudo, ocorrem algumas diferenças dentre as quais já apresentamos no <a href="nbasico.html#rhistory">módulo básico</a>, a presença do <strong>escopo léxico</strong> no <code>R</code>, que não ocorre na linguagem <code>S</code>. Desse modo, percebemos que o <code>R</code> é uma <strong>linguagem interpretada</strong>, pois além da linguagem <code>S</code> (o que fácil para os usuários a implementação do código), a sua base foi programada em <code>C</code> e <code>FORTRAN</code> (para computação mais intensiva). Mas também, adjetivamos o <code>R</code> como <strong>ambiente de software</strong> ao invés de apenas <strong>software</strong>, e aqui predominaremos esse termo, pois segundo ainda na própia página do <code>R</code> se “pretende caracterizá-lo como um sistema totalmente planejado e coerente, ao invés de um acréscimo incremental de ferramentas muito específicas e inflexíveis, como é frequentemente o caso com <em>outros softwares de análise de dados</em>.” Assim, esse ambiente inclui:</p>
<ul>
<li>manipulação de dados;</li>
<li>operações com matrizes;</li>
<li>coleção de ferramentas para análise de dados;</li>
<li>criação e apresentações gráficas, para apresentação dos dados;</li>
<li>linguagem que inclui condicionais, fluxos de controle, funções recursivas definidas pelo usuário e recursos de entrada e saída;</li>
<li>Documentação e relatórios de análises.</li>
</ul>
<p>Existem linguagens como <code>C</code> e <code>FORTRAN</code>, por exemplo, que a execução do código nessas linguagem precisam de uma compilação, para depois serem executadas, isto é, as linhas de códigos programadas pelo usuário precisam ser convertidas na linguagem de máquina, para que depois seja executa. Porém, no <code>R</code>, quando escrevemos uma linha de comando no console, do tipo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 10</code></pre>
</div>
<p>Percebemos no <code>R</code> o código é automaticamente interpretado conforme o usuário executa. Desse modo, caracterizamos a linguagem de <strong>programação dinâmica</strong>. A ideia se estende a avaliação de funções, a extensão da linguagem sem o uso de macros, e a manipulação com ambiente. Ainda mais, podemos afirmar também que essa dinamicidade está relacionada ao fato do <code>R</code> também ser uma <strong>linguagem fortemente e dinamicamente tipada</strong>. Nesse caso, os valores contidos nos objetos é que são tipados. Por exemplo, vetores atômicos apresentam sempre elementos com mesmo tipo. Porém, à medida que adicionamos elementos ao vetor, pode haver a coersão da tipagem dos elementos, quando esses elementos apresentam tipos diferentes, como foi abordado no módulo básico, na seção <a href="nbasico.html#coersao">coersão</a>. Vejamos um exemplo, a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vetor</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>; <span class='fu'><a href='https://rdrr.io/r/base/typeof.html'>typeof</a></span><span class='op'>(</span><span class='va'>vetor</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;logical&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vetor</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>; <span class='fu'><a href='https://rdrr.io/r/base/typeof.html'>typeof</a></span><span class='op'>(</span><span class='va'>vetor</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;double&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vetor</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"1"</span>; <span class='fu'><a href='https://rdrr.io/r/base/typeof.html'>typeof</a></span><span class='op'>(</span><span class='va'>vetor</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;character&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vetor</span>
</code></pre>
</div>
<pre><code>[1] &quot;1&quot; &quot;1&quot; &quot;1&quot;</code></pre>
</div>
<p>Observemos que o objeto associado ao nome <code>vetor</code> vai alterando a tipagem por coersão, é o comportamento dinâmico da linguagem. Observe que o nome <code>vetor</code> é um objeto de tipo <em>symbol</em> e o vetor <code>c("1", "1" "1")</code> é outro objeto, cujos os elementos foram coagidos a tipagem <code>character</code>. Claro, que o acesso ao vetor só é possível recuperar da memória ativa, se este estiver associado a algum nome, no caso <code>vetor</code>. Porém, não é o nome que altera o seu tipo, mas os elementos do objeto associado a este nome, em que, por ser um verto atômico, seus elementos devem apresentar o mesmo tipo.</p>
<p>A ideia do <code>R</code> como uma linguagem de programação com <strong>estilo funcional</strong>, se deve pelo fato da linguagem ter funções de primeira classe, <code>function()</code>, isto é, funções que se comportam como qualquer outro objeto no ambiente <code>R</code>. Por exemplo, podemos atribuir nomes as nossas funções, armazená-las em listas, serem criadas dentro de outras funções, serem argumentos de outras funções, ou até ser um resultado de uma função. Inclusive na versão do <code>R</code> 4.1, a função <code>function()</code> ganhou um novo formato, que também pode ser usado. Vejamos o exemplo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Forma original</span>
<span class='va'>soma1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>1</span>; <span class='fu'>soma1</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Forma alternativa (&gt;= R 4.1)</span>
<span class='va'>soma1</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>1</span>; <span class='fu'>soma1</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2</code></pre>
</div>
<p>Para complementar atualizações dessa versão, uma outra importante foi implemento da função <em>pipe</em> (<code>%&gt;%</code>). Originalmente, a função <em>pipe</em> (lê-se paipe) é do pacote <a href="https://magrittr.tidyverse.org/">magrittr</a> da família de pacotes <a href="https://www.tidyverse.org/">tidyverse</a>, do qual é um operador binário em que o primeiro operando é um objeto para a entrada de dados, e o segundo é uma função. Nesse caso, o objeto no primeiro operando entrará no primeiro argumento da função no segundo operando. Vejamos um exemplo, a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># install.packages(magrittr) # Instalando o pacote</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span> <span class='co'># anexando o pacote</span>
<span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span> <span class='op'>%&gt;%</span> <span class='va'>mean</span>
</code></pre>
</div>
<pre><code>[1] 5.5</code></pre>
</div>
<p>Observe que calculamos a média do vetor <code>1:10</code>. Agora, a versão do <em>pipe</em> nativa no <code>R</code> (&gt;= 4.1), sua sintaxe é <code>|&gt;</code>. Vejamos o mesmo exemplo usado anteriormente, agora com a função nativa, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span> |&gt; <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 5.5</code></pre>
</div>
<p>A diferença no caso do <em>pipe</em> nativo é que no segundo argumento, além do nome da função, acrescemos o parênteses sem seus argumentos. <strong>Lembrando que o primeiro operando entrará no primeiro argumento da função (segundo operando)</strong>.</p>
<p>Retornando a programação funcional, sabemos que o <code>R</code> não é estritamente funcional. A definição de programação funcional apresenta algumas características, dentre elas, que a linguagem apresente:</p>
<ul>
<li>Composição de funções;</li>
<li>Funções puras;</li>
<li>Imutabilidade;</li>
<li>Efeito colateral;</li>
</ul>
<p>A ideia da <strong>composição de funções</strong> representa a criação de funções por meio de outras funções, e isso está dentro da linguagem <code>R</code>. Por exemplo, vamos criar uma função que calcula a média de um conjunto de dados, usando a função, <code>mean()</code>, já existente no pacote <code>base</code>, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>
<span class='va'>media</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='fu'>media</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 5.5</code></pre>
</div>
<p>A caracterização de <strong>funções puras</strong>, significa que as funções sempre retornam o mesmo resultado, dados os mesmos parâmetros de entrada, isto significa que não existe <strong>efeito colateral</strong>. Um exemplo de função pura, pode ser como:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fpura</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"x deve ser numérico"</span><span class='op'>)</span>
  <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>1</span>
<span class='op'>}</span>
<span class='fu'>fpura</span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3</code></pre>
</div>
<p>Observe que <code>fpura()</code> toda vez que a entrada for <code>x = 2</code>, o resultado sempre será o resultado <code>3</code>. Porém, o <code>R</code> se exclui dessa característica estritamente funcional, quando aprensentamos funções: <code>runif()</code>, <code>rnorm()</code>, <code>read.csv()</code>, dentre outras. Por exemplo, a função <code>rnorm()</code> representa um gerador de números aleatórios de uma distribuição normal, do qual se executarmos essa função, mais de uma vez, usando a mesma entrada para o argumento <code>n = 3</code>, o resultado não será sempre o mesmo, observe:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  1.0337700  0.3647557 -0.2428575</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -1.5657441  0.6763031 -1.4781201</code></pre>
</div>
<p>A <strong>imutabilidade</strong> na programação funcional apresenta em uma linguagem na situação em que uma variável ou objeto é criado, e este não pode ser modificado. Esta é outra característica que ocorre no <code>R</code>, mas não para todos os objetos em que exitem nomes associados, é o caso da <strong>modificação no local</strong>. Por exemplo, vamos apresentar um contra-exemplo de que nem todos os objetos no <code>R</code> são imutáveis. Vejamos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Criamos um vetor e associamos ao nome 'x'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>
<span class='co'># Vejamos o identificador de memória</span>
<span class='fu'>lobstr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lobstr/man/obj_addr.html'>obj_addr</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='co'># &gt; "0xcf09be4708"</span>
<span class='co'># Modificando no local</span>
<span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>4</span>; <span class='va'>x</span>
<span class='co'># [1] 1 4 3</span>
<span class='co'># Mesmo modificando o objeto, o identificador eh o mesmo</span>
<span class='fu'>lobstr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lobstr/man/obj_addr.html'>obj_addr</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='co'># &gt; "0xcf09be4708"</span>
</code></pre>
</div>
</div>
<p>Para a execução dessas linhas de comando, sugerimos que não utilizem diretamente o RStudio, porque a IDE sempre faz uma referência a cada objeto. Sugerimos que utilize a própria interface do <code>R</code>. Esse tema será aprodundado mais a frente, na seção <a href="#aprof-objetos">entendendo um pouco mais sobre objetos</a>.</p>
<p>Por fim, duas outras características importantes do estilo funcional da linguagem, é o <strong>escopo léxico</strong> das funções, assunto abordado no <a href="nbasico.html">módulo básico</a>, e a <strong>execução preguiçosa</strong>, do qual o argumentos das funções são avaliados apenas quando utilizados. Vejamos, o exemplo a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>preguicoso</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>b</span> <span class='op'>=</span> <span class='fu'>faux</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>  <span class='va'>a</span> <span class='op'>*</span> <span class='fl'>100</span>
<span class='fu'>preguicoso</span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 400</code></pre>
</div>
<p>Observemos nesse caso, que o argumento <code>b</code> recebe uma função <code>aux()</code> que não existe. Contudo, ao executar a linha de comando seguindo, a função <code>preguicoso</code> retorna o resultado <code>400</code> sem erro. Isso porque como não foi necessário utilizar o argumento <code>b</code> no corpo da função, este não foi avaliado, e portanto, sem retorno de erro da função <code>preguicoso</code>. Iremos mais a frente, detalhar essa característica de modo mais aprofundado.</p>
<p>O <code>R</code> não é uma linguagem totalmente orientada a objetos, como afirmado por alguns. Apesar, de um dos princípios do <code>R</code> que tudo é um objeto, não significa dizer que tudo é orientado a objetos. Isso se deve ao fato de que os primeiro objetos criados no <code>R</code>, que chamaremos de <strong>objetos base</strong>, foram desenvolvidos baseados na linguagem <code>S</code>. E nesse tempo não havia qualquer cogitação de que fosse necessário um sistema de programação orientada a objetos (POO). Veremos mais a frente, que a distinção básica entre objetos base e objetos baseados em sistemas orientados a objetos, chamaremos de <strong>objetos POO</strong>, é que estes últimos terão o atributo <code>class</code>, do qual podemos consultá-lo pela função <code>attr()</code>. Vejamos, alguns exemplos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objetos POO</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='fu'>ggplot2</span><span class='fu'>::</span><span class='va'><a href='https://ggplot2.tidyverse.org/reference/diamonds.html'>diamonds</a></span>, <span class='st'>"class"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objetos base</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='st'>"class"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>NULL</code></pre>
</div>
<p>Quando não há o atributo <code>class</code>, isto é, <code>NULL</code>, é objeto base. Contudo, iremos na seção <a href="#poo">Programação orientada a objetos</a> saber em que sistemas esses objetos estão orientados, porque no <code>R</code>, diferentemente de outras linguagens, existem vários sistemas POO, como: S3, S4 R5 (classes de referências), R6, dentre outros.</p>
<p>Por fim, como última caracterização do <code>R</code> abordada é como uma linguagem de programação metaparadigma ocorre porque pela própria linguagem, poderemos inspecioná-la, modificá-la, por ela mesma, como se fosse um objeto, o que acaba tornando uma ferramenta muito poderosa. E isso será tema abordado mais a frente.</p>
<p>Portanto, esclarecido isso, e ainda com as demais características apresentadas no <a href="nbasico.html">módulo básico</a>, dizemos que o <code>R</code> é:</p>
<ul>
<li>um ambiente de software livre e código aberto, com licença GNU;</li>
<li>umalinguagem de programação interpretada;</li>
<li>uma linguagem de programação dinâmica;</li>
<li>uma linguagem de programação funcional;
<ul>
<li>de escopo lêxico;</li>
<li>avaliação preguiçosa;</li>
</ul></li>
<li>uma linguagem de programação orientada a objetos;</li>
<li>uma linguagem de tipagem forte e dinâmica; e</li>
<li>uma linguagem de programação metaparadigma.</li>
</ul>
<!-- # Evolução do R -->
<!-- https://en.wikipedia.org/wiki/R_(programming_language) -->
<h1 id="poo"><i class="fas fa-puzzle-piece"></i> Programação orientada a objetos</h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/x4gpW5Ip-uE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>Assim como no nosso dia a dia podemos realizar uma mesma tarefa de modos diferentes, isso ocorre também na programação. Nesse caso, dizemos que esses modos são os paradigmas da programação. E a programação orientada a objetos (POO) é um desses paradigmas que veio para contornar alguns problemas da programação estrutural, um outro paradigma.</p>
<p>Antes de apresentarmos outras diferenças entre os objetos base e objetos OO, se faz necessário entendermos alguns conceitos da POO, do qual tudo se desencadeará pelos termos <strong>classe</strong>, <strong>objeto</strong> e <strong>método</strong>. Para isso, vamos ilustrar alguns termos baseados no nosso cotidiano. Uma das grandes cobiças nessa era digital é ter um bom <em>smartphone</em> para que possamos estar conectados nessa era digital, bem não sei se foi bem esse objetivo do <em>smartphone</em>, mas consideremos que tenha sido. Essa escolha se deve a algumas <em>características</em> tamanho, cor, desempenho, câmera, dentre outras. Outro fator que pode ter sido o motido da sua escolha é o <em>comportamento</em> desse celular, como o seu desempenho do processador, a velocidade com o qual se desenvolve as atividades, a forma como os aplicativos reagem as suas ações, o sistema como o algoritmo baseado em inteligência artificial interage com todo o sistema operacional do aparelho, dentre outros. Nesse momento, fazendo uma relação com o ambiente <code>R</code>, dizemos que o celular que desejamos é o objeto, suas características são os atributos do objeto, e o comportamento será o método aplicado a este objeto na programação orientada a objetos.</p>
<p>Mesmo que seu aparelho apresente um IMEI (Código de identificação do aparelho) único, nós sabemos que existem diversos aparelhos com essa mesma configuração, modelo e marca, alguns outros com pequenas características que o diferenciam, mas conseguimos identificar ainda assim, esse objeto como um celular. Portanto, podemos dizer que o celular é uma <em>classe</em> para o ambiente <code>R</code>, em que apesar de termos diversos objetos, estes são identificados dentro de um conjunto de características que o definem como celular. Nesse caso, dizemos ainda que o celular que escolhemos é uma <em>instância</em> dessa classe, que apesar de ter atributos próprios, ainda assim, é identificado como um celular. Desse modo, ao ser definidos as classes de determinados objetos, a linguagem saberá utilizar o método correto para tal objeto, isso significa que mesmo que não saibamos como ocorre, devemos confiar que ocorrerá. Isso é programação orientada a objetos.</p>
<p>Teríamos mais analogias para abordar, como <strong>encapsulamento</strong>, <strong>hierarquias</strong> , <strong>envio (ou despacho) de método</strong>, <strong>polimorfismo</strong>, <strong>subclasses</strong>, <strong>superclasses</strong>, dentre outras. Mas, vamos deixar para discutir ao longo das aplicações.</p>
<p>Assim, esse paradigma da programação permite associarmos o desenvolvimento do nosso código pra dentro de nossa realidade humana. Porém a ideia de POO dentro do <code>R</code> sai do escopo de implementações densenvolvidas em outras linguagens. Antes de entrarmos no tema propriamente dito, queremos ressaltar que não estamos interessados em repassar uma POO eficiente, devido a todo o cunho teórico exigido para o assunto. Mas, queremos repassar como os principais sistemas de POO foram desenvolvidos dentro do <code>R</code>.</p>
<h2 id="objetos-oo-base">Nem tudo é orientado a objetos no R</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/npVwzYBIpZ0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>Uma primeira ideia que temos que saber é que apenas de um dos princípios que tudo no <code>R</code> é um objeto, mas nem tudo é orientado a objetos. Isso ocorre, porque discutimos anteriormente, que o <code>R</code> é um dialeto da linguagem <code>S</code>. No início do desenvolvimento da linguagem <code>S</code>, John Chambers e seus colaboradores nem cogitavam para a implementação do código a programação orientada a objetos, desse modo, o <code>R</code> quando começou a ser densevolvido, os primeiros objetos desenvolvidos foram vêm dessas primeiras versões da linguagem <code>S</code>, sem ainda a implementação de POO.</p>
<p>Dessa forma, vamos distinguir o <code>R</code> com dois tipos de objetos:</p>
<ul>
<li><strong>Objetos POO</strong> (Objetos para POO)</li>
<li><strong>Objetos base</strong> (Objetos não voltados a POO)</li>
</ul>
<p>A principal diferença técnica é que um <strong>objeto POO</strong> terá o atributo <code>class</code>, e o <strong>objeto base</strong>, não. Vejamos,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto "data.frame"</span>
<span class='va'>objPOO</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='st'>"1"</span>, c <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='co'># Objeto "data.frame" eh um objeto POO?</span>
<span class='fu'><a href='https://rdrr.io/r/base/is.object.html'>is.object</a></span><span class='op'>(</span><span class='va'>objPOO</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Vetor de comprimento 10</span>
<span class='va'>objBASE</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>
<span class='co'># O vetor eh um objeto POO?</span>
<span class='fu'><a href='https://rdrr.io/r/base/is.object.html'>is.object</a></span><span class='op'>(</span><span class='va'>objBASE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
</div>
<p>Pela função <code>is.object()</code>, sabemos se um objeto é de POO ou não. Entretanto, no <code>R</code> temos diversos sistemas POO, alguns da base de instalação do programa, e outros disponíveis no CRAN. Detalharemos os tipos, a seguir.</p>
<h2 id="objetos-base">Objetos base</h2>
<p>Existem 24 tipos de objetos diferentes no <code>R</code> (antes eram 26, porém o objetos referentes a fatores e fatores ordenados foram retirados). A base de criação desses objetos foram a linguagem <code>C</code>, e que na realidade são ponteiros para uma estrutura com <code>typedef</code> <code>SEXPREC</code>. Os seus tipos estão representados por <code>SEXPTYPE</code>, que determina como as características da estrutura são usadas. Para mais detalhes, ler <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html">R Language Definition</a> e <a href="https://cran.r-project.org/doc/manuals/r-release/R-ints.html">R Internals</a>. Alguns tipos são importantes para o usuário <code>R</code>, outros apenas com importância interna ao ambiente <code>R</code>, dos quais esses tipos podem ser identificados pela função <code>typeof()</code>, que segue:</p>
<table>
<colgroup>
<col style="width: 39%" />
<col style="width: 41%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Representação em <code>R</code></th>
<th style="text-align: left;">Representação em <code>C</code> (<code>SEXPTYPE</code>)</th>
<th style="text-align: left;">Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>NULL</code></td>
<td style="text-align: left;"><code>NILSXP</code></td>
<td style="text-align: left;">Único vetor que tem comprimento zero e não pode ter atributo</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>logical</code></td>
<td style="text-align: left;"><code>LGLSXP</code></td>
<td style="text-align: left;">Vetores lógicos</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>integer</code></td>
<td style="text-align: left;"><code>INTSXP</code></td>
<td style="text-align: left;">Vetores inteiros</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>double</code></td>
<td style="text-align: left;"><code>REALSXP</code></td>
<td style="text-align: left;">Vetores reais</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>complex</code></td>
<td style="text-align: left;"><code>CPLXSXP</code></td>
<td style="text-align: left;">Vetores complexos</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>character</code></td>
<td style="text-align: left;"><code>STRSXP</code></td>
<td style="text-align: left;">Vetores caracteres (<em>strings</em>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>list</code></td>
<td style="text-align: left;"><code>VECSXP</code></td>
<td style="text-align: left;">Listas</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>raw</code></td>
<td style="text-align: left;"><code>RAWSXP</code></td>
<td style="text-align: left;">Vetores brutos</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>closure</code></td>
<td style="text-align: left;"><code>CLOSXP</code></td>
<td style="text-align: left;">Funções criadas por meio de <code>function()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>special</code></td>
<td style="text-align: left;"><code>SPECIALSXP</code></td>
<td style="text-align: left;">Funções primitivas (funções básicas e operadores) que são escritas principalmente na linguagem <code>C</code>. Desse modo, essas funções não apresentam as três estruturas básicas de uma função do tipo <code>closure</code>, como <code>formals()</code>, <code>body()</code>, <code>environment()</code>, que são todas <code>NULL</code>. Aprofundaremos esse objeto no <a href="navancado.html">módulo avançado</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>bultin</code></td>
<td style="text-align: left;"><code>BUILTINSXP</code></td>
<td style="text-align: left;">Funções primitivas (funções básicas e operadores) que são escritas principalmente na linguagem <code>C</code>. Desse modo, essas funções não apresentam as três estruturas básicas de uma função do tipo <code>closure</code>, como <code>formals()</code>, <code>body()</code>, <code>environment()</code>, que são todas <code>NULL</code>. Aprofundaremos esse objeto no <a href="navancado.html">módulo avançado</a></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>environment</code></td>
<td style="text-align: left;"><code>ENVSXP</code></td>
<td style="text-align: left;">Ambientes</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>S4</code></td>
<td style="text-align: left;"><code>S4SXP</code></td>
<td style="text-align: left;">Objetos com sistema POO <strong>S4</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>symbol</code></td>
<td style="text-align: left;"><code>SYMSXP</code></td>
<td style="text-align: left;">Nomes associados aos objetos</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>language</code></td>
<td style="text-align: left;"><code>LANGSXP</code></td>
<td style="text-align: left;">Objetos de linguagem, que abordaremos na seção sobre metaprogramação</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pairlist</code></td>
<td style="text-align: left;"><code>LISTSXP</code></td>
<td style="text-align: left;">Argumento das funções</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>expression</code></td>
<td style="text-align: left;"><code>EXPRESXP</code></td>
<td style="text-align: left;">Vetores de expressão</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>externalptr</code></td>
<td style="text-align: left;"><code>EXTPTRSXP</code></td>
<td style="text-align: left;">Apontador externo, são vetores exóticos que tem importância para a linguagem <code>C</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>weakref</code></td>
<td style="text-align: left;"><code>WEAKREFSXP</code></td>
<td style="text-align: left;">Referência fraca, são vetores exóticos que tem importância para a linguagem <code>C</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bytecode</code></td>
<td style="text-align: left;"><code>BCODESXP</code></td>
<td style="text-align: left;">Código de byte, são vetores exóticos que tem importância para a linguagem <code>C</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>promise</code></td>
<td style="text-align: left;"><code>PROMSXP</code></td>
<td style="text-align: left;">Promessas, são objetos responsáveis pelo pelo carregamento preguiçoso dos argumentos de uma função</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>...</code></td>
<td style="text-align: left;"><code>DOTSXP</code></td>
<td style="text-align: left;">Objeto utilizado como um argumento da função, após a criação de uma função, ainda assim, podem ser inseridos mais argumentos</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>any</code></td>
<td style="text-align: left;"><code>ANYSXP</code></td>
<td style="text-align: left;">Objeto que representa de qualquer tipo. Raramente utilizado em <code>R</code>, mas aparece por exemplo em <code>as.vector(x, mode = "any")</code>, considerando que <code>x</code> é um objeto <code>R</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">-</td>
<td style="text-align: left;"><code>CHARSXP</code></td>
<td style="text-align: left;">Cadeia de caracteres internas, isto é, um tipo de escalar <em>string</em>, usado somente internamente</td>
</tr>
</tbody>
</table>
<p>Todas as funcões que usam esses <strong>objetos base</strong> e apresentam comportamento diferentes, não usam o sitema POO, porque foram implementadas em sua maioria na linguagem <code>C</code>, usando a instrução <code>switch</code>, em que também aprofundaremos no <a href="navancado.html">módulo avançado</a>.</p>
<h2 id="sistemas-poo">Sistemas de POO no <code>R</code></h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/nvSuHOK5ZPE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>Usando as ideias de <span class="citation" data-cites="chambers2016"><a href="#ref-chambers2016" role="doc-biblioref">Chambers</a> (<a href="#ref-chambers2016" role="doc-biblioref">2016</a>)</span>, complementadas por <span class="citation" data-cites="hadley2019"><a href="#ref-hadley2019" role="doc-biblioref">Wickham</a> (<a href="#ref-hadley2019" role="doc-biblioref">2019</a>)</span>, dizemos que o paradigma da programação orientada a objetos pode ser dividida em dois ramos:</p>
<ul>
<li><strong>POO encapsulada</strong>: os métodos são encapsulado em suas classes, isto é, os objetos nesse estilo de programação contém os seus comportamentos;</li>
<li><strong>POO funcional</strong>: os métodos pertencem as funções, das quais serão aplicadas aos objetos de determinada classe.</li>
</ul>
<p>O <code>R</code> em sua base, apresenta três sistemas de POO: <strong>S3</strong>, <strong>S4</strong> e <strong>CR</strong> (classes de referência). No <em>CRAN</em>, existem diversas implementações de POO, das quais podemos citar: <strong>R6</strong> (pacote <a href="https://r6.r-lib.org/">R6</a>), <a href="https://github.com/HenrikBengtsson/R.oo">R.oo</a>, <a href="https://github.com/hadley/proto">proto</a>, dentre outros.</p>
<p>Exploraremos para esse momento, apenas o sistema <strong>S3</strong> (POO funcional), em que o sitema <strong>S4</strong> também apresenta o paradigma POO funcional. Esses dois sistemas foram a evolução da implementação de POO na linguagem <code>S</code> implementadas no <code>R</code>. Contudo, os seus nomes geram a impressão de que também haviam os sistemas S1 e S2, mas não, os nomes <strong>S3</strong> e <strong>S4</strong> se devem as versões da linguagem <code>S</code>, como evolução da linguagem em si. Nesses momentos, foram o marco para a incorporação da programação orientada a objetos na linguagem, em que antes não existia, por isso, não haver sistemas S1 e S2.</p>
<p>Para complementar a carcterização dos sistemas citados, os sistemas <strong>RC</strong> e <strong>R6</strong> apresentam o paradigma POO encapsulado. Os demais sistemas implementados nos pacotes disponíveis no CRAN, como <a href="https://github.com/HenrikBengtsson/R.oo">R.oo</a> fornece algum formalismo em cima de S3 e torna possível ter objetos S3 mutáveis (<span class="citation" data-cites="hadley2019"><a href="#ref-hadley2019" role="doc-biblioref">Wickham</a> (<a href="#ref-hadley2019" role="doc-biblioref">2019</a>)</span>), e <a href="https://github.com/hadley/proto">proto</a> que implementa outro estilo de OOP baseado na ideia de protótipos , que confundem as distinções entre classes e instâncias de classes (objetos) (<span class="citation" data-cites="hadley2019"><a href="#ref-hadley2019" role="doc-biblioref">Wickham</a> (<a href="#ref-hadley2019" role="doc-biblioref">2019</a>)</span>), do qual foi o sistema implementado para o pacote <a href="https://ggplot2.tidyverse.org/">ggplot2</a>.</p>
<h2 id="sistemaS3">Sistema S3</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/aMTHWwYKiNQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<!-- Depois modificar esse parágrafo inicial, após descrever os demais métodos -->
<p>Poderíamos descrever todos os sistemas, porém restringiremos ao sistema <strong>S3</strong>, por uma única razão, é o sistema amplamente empregado aos objetos dos pacotes <strong>base</strong> e <strong>stats</strong>, bem como na maioria dos pacotes disponíveis no <em>CRAN</em>. Mais detalhes sobre o sistema, sugerimos leituras em <span class="citation" data-cites="chambers2016"><a href="#ref-chambers2016" role="doc-biblioref">Chambers</a> (<a href="#ref-chambers2016" role="doc-biblioref">2016</a>)</span>, <span class="citation" data-cites="hadley2019"><a href="#ref-hadley2019" role="doc-biblioref">Wickham</a> (<a href="#ref-hadley2019" role="doc-biblioref">2019</a>)</span>, <span class="citation" data-cites="chambers2008"><a href="#ref-chambers2008" role="doc-biblioref">Chambers</a> (<a href="#ref-chambers2008" role="doc-biblioref">2008</a>)</span>, <span class="citation" data-cites="chambers1991"><a href="#ref-chambers1991" role="doc-biblioref">Chambers and Hastie</a> (<a href="#ref-chambers1991" role="doc-biblioref">1991</a>)</span>, dentre outros materiais.</p>
<p>Como falado anteriormente, um objeto POO terá sempre um atributo <code>class</code>, em que podemos utilizar a função <code>atributes</code> para verificar isso. Vejamos,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>quadro_dados</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='cn'>TRUE</span>, c <span class='op'>=</span> <span class='st'>"A"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>quadro_dados</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$names
[1] &quot;a&quot; &quot;b&quot; &quot;c&quot;

$class
[1] &quot;data.frame&quot;

$row.names
[1] 1</code></pre>
</div>
<p>O fato do objeto <code>quadro_dados</code> ter o atributo <code>class=data.frame</code>, lhe dá um comportamento especial a determinadas funções genéricas. Vejamos como imprimos essa função pela funcão <code>print()</code>, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>quadro_dados</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  a    b c
1 1 TRUE A</code></pre>
</div>
<p>Removendo esse atributo do objeto, por meio da função <code>unclass()</code>, voltamos ao tipo de objeto base subjascente. Dessa forma, a função <code>print</code> perde esse comportamento especial, apresentada a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>unclass</a></span><span class='op'>(</span><span class='va'>quadro_dados</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$a
[1] 1

$b
[1] TRUE

$c
[1] &quot;A&quot;

attr(,&quot;row.names&quot;)
[1] 1</code></pre>
</div>
<p>Isso significa, que o objeto <code>data.frame</code> perde seu comportamento especial e retorna ao mesmo comportamento de uma lista. Afinal, falamos no módulo básico que um objeto <code>data.frame</code> é uma lista.</p>
<h3 id="fgenericas">Funções genéricas</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/wQiwTa-s9Bw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>A base do sistema <strong>S3</strong> está nas <strong>funções genéricas</strong> ou também podemos chamar de <strong>genéricos</strong>, que buscam o método específico para determinada classe de um objeto. Esta função representa um intermediário do sistema <strong>S3</strong>, do qual define os argumentos de entrada, e na sequência, encontra o método certo, baseado na classe do objeto associado ao primeiro argumento da função genérica. Para sabermos se uma função é genérica, temos algumas funções: <code>utils::isS3stdGeneric()</code> e <code>sloop::ftype()</code>. Verificando esta última função, além de informar se é uma função genérica, informa também o sistema POO, além do que a função <code>utils::isS3stdGeneric()</code> apenas retorna <code>TRUE</code>, as funções genéricas <strong>S3</strong> que apresentam no corpo de sua função, a chamada <code>UseMethod</code>. Vale lembrar, que funções primitivas/internas não apresentam essa chamada de função. Dessa forma, usaremos, principalmente, a função <code>sloop::ftype()</code> como pesquisa por funções genéricas. Vejamos,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Funcoes do tipo "closure" que nao pertencem ao sistema S3</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/isS3stdGen.html'>isS3stdGeneric</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/ftype.html'>ftype</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;function&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Funcao generica S3 em funcoes do tipo "closure"</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/isS3stdGen.html'>isS3stdGeneric</a></span><span class='op'>(</span><span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>mean 
TRUE </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/ftype.html'>ftype</a></span><span class='op'>(</span><span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;S3&quot;      &quot;generic&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># funcoes primitivas e internas que nao pertencem ao sistema S3</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/isS3stdGen.html'>isS3stdGeneric</a></span><span class='op'>(</span><span class='va'>inherits</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/ftype.html'>ftype</a></span><span class='op'>(</span><span class='va'>inherits</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;internal&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#-----</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/isS3stdGen.html'>isS3stdGeneric</a></span><span class='op'>(</span><span class='va'>unclass</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/ftype.html'>ftype</a></span><span class='op'>(</span><span class='va'>unclass</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;primitive&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># funcoes genericas do sistema S3 que sao primitivas e internas</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/isS3stdGen.html'>isS3stdGeneric</a></span><span class='op'>(</span><span class='va'>length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/ftype.html'>ftype</a></span><span class='op'>(</span><span class='va'>length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;primitive&quot; &quot;generic&quot;  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#--</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/isS3stdGen.html'>isS3stdGeneric</a></span><span class='op'>(</span><span class='va'>unlist</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/ftype.html'>ftype</a></span><span class='op'>(</span><span class='va'>unlist</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;internal&quot; &quot;generic&quot; </code></pre>
</div>
<p>A função <code>sloop::ftype()</code> retorna um vetor de caracteres de comprimento 1 ou 2. Quando retorna apenas um valor, do qual não obtemos o resultado <code>generic</code>, significa que esta função não é genérica, como é o caso da função <code>data</code>. Quando há um retorno de dois valores, e um deles é <code>generic</code>, significa dizer que a função é genérica, em que o primeiro valor, representa o sistema POO, como é o caso da função <code>mean</code>. No caso, das funções primitivas/internas que estão no pacote <code>base</code>, o primeiro resultado da função <code>sloop::ftype()</code> para a referida função será <code>primitive</code> ou <code>internal</code>, e se houver o segundo valor de nome <code>generic</code>, se confirma que também é um função primitiva genérica do método <strong>S3</strong>.</p>
<p>As funções genéricas do tipo <code>closure</code> terão no corpo de sua função a chamada <code>UseMethod</code>, uma função primitiva . Essa é a identificação básica de uma função genérica. Podemos observar, como exemplo, a função <code>mean</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mean</span>
</code></pre>
</div>
<pre><code>function (x, ...) 
UseMethod(&quot;mean&quot;)
&lt;bytecode: 0x0000000008e54290&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
<p>Entretanto, funções primitivas e internas são escritas em linguagem <code>C</code>, mas também podem ser funções genéricas. Não há função no <a href="http://r-project.org/" target="_blank">R</a> para acesso direto do código interno interno dessas funções, bem como de seus argumentos. O que na realidade deve ser feito é acessar código fonte. Para isso, podemos pesquisar sobre alguma função primitiva, por exemplo <code>'[['</code>, por <code>pryr::show_c_source(.Primitive("[["))</code>.</p>
<p>O que ocorre nesse caso, é que estas funções não usam a chamada <code>UseMethod</code>. Desse modo, as funções primitivas e internas podem ser identificadas, pelo objeto <code>.S3PrimitiveGenerics</code>, um vetor de caracteres, que seguem:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>.S3PrimitiveGenerics</span>
</code></pre>
</div>
<pre><code> [1] &quot;anyNA&quot;          &quot;as.character&quot;   &quot;as.complex&quot;    
 [4] &quot;as.double&quot;      &quot;as.environment&quot; &quot;as.integer&quot;    
 [7] &quot;as.logical&quot;     &quot;as.call&quot;        &quot;as.numeric&quot;    
[10] &quot;as.raw&quot;         &quot;c&quot;              &quot;dim&quot;           
[13] &quot;dim&lt;-&quot;          &quot;dimnames&quot;       &quot;dimnames&lt;-&quot;    
[16] &quot;is.array&quot;       &quot;is.finite&quot;      &quot;is.infinite&quot;   
[19] &quot;is.matrix&quot;      &quot;is.na&quot;          &quot;is.nan&quot;        
[22] &quot;is.numeric&quot;     &quot;length&quot;         &quot;length&lt;-&quot;      
[25] &quot;levels&lt;-&quot;       &quot;names&quot;          &quot;names&lt;-&quot;       
[28] &quot;rep&quot;            &quot;seq.int&quot;        &quot;xtfrm&quot;         </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Outras funcoes primitivas</span>
<span class='op'>(</span><span class='va'>outros_obj_S3_primitivos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"["</span>, <span class='st'>"[["</span>, <span class='st'>"$"</span>, <span class='st'>"[&lt;-"</span>, <span class='st'>"[[&lt;-"</span>, <span class='st'>"$&lt;-"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;[&quot;    &quot;[[&quot;   &quot;$&quot;    &quot;[&lt;-&quot;  &quot;[[&lt;-&quot; &quot;$&lt;-&quot; </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Outras funcoes internas nao primitivas</span>
<span class='op'>(</span><span class='va'>outros_obj_S3_primitivos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"unlist"</span>, <span class='st'>"cbind"</span>, <span class='st'>"rbind"</span>, <span class='st'>"as.vector"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;unlist&quot;    &quot;cbind&quot;     &quot;rbind&quot;     &quot;as.vector&quot;</code></pre>
</div>
<p>Algumas outras funções como <code>is.name</code> que é sinônimo da função <code>is.symbol</code>, assim como a função <code>as.numeric</code> é sinônimo da função <code>as.double</code>. Existem outras funções genéricas que também são primitivas/internas, são as funções genéricas do grupo <strong>S3</strong> que não estão descritos no objeto <code>.S3PrimitiveGenerics</code>. Há quatro desses grupos para que os métodos <strong>S3</strong> podem ser escritos, denominados: grupo <code>Math</code>, grupo <code>Ops</code>, grupo <code>Summary</code> e grupo <code>Complex</code>. Detalhamos as funções:</p>
<ul>
<li>Grupo <code>Math</code>:
<ul>
<li><code>abs</code>, <code>sign</code>, <code>sqrt</code>, <code>floor</code>, <code>ceiling</code>, <code>trunc</code>, <code>round</code>, <code>signif</code></li>
<li><code>exp</code>, <code>log</code>, <code>expm1</code>, <code>log1p</code>, <code>cos</code>, <code>sin</code>, <code>tan</code>, <code>cospi</code>, <code>sinpi</code>, <code>tanpi</code>, <code>acos</code>, <code>asin</code>, <code>atan</code>, <code>cosh</code>, <code>sinh</code>, <code>tanh</code>, <code>acosh</code>, <code>asinh</code>, <code>atanh</code></li>
<li><code>lgamma</code>, <code>gamma</code>, <code>digamma</code>, <code>trigamma</code></li>
<li><code>cumsum</code>, <code>cumprod</code>, <code>cummax</code>, <code>cummin</code></li>
</ul></li>
<li>Grupo <code>Ops</code>:
<ul>
<li><code>"+"</code>, <code>"-"</code>, <code>"*"</code>, <code>"/"</code>, <code>"^"</code>, <code>"%%"</code>, <code>"%/%"</code></li>
<li><code>"&amp;"</code>, <code>"|"</code>, <code>"!"</code></li>
<li><code>"=="</code>, <code>"!="</code>, <code>"&lt;"</code>, <code>"&lt;="</code>, <code>"&gt;="</code>, <code>"&gt;"</code></li>
</ul></li>
<li>Grupo <code>Summary</code>:
<ul>
<li><code>all</code>, <code>any</code>, <code>sum</code>, <code>prod</code>, <code>min</code>, <code>max</code>, <code>range</code></li>
</ul></li>
<li>Grupo <code>Complex</code>:
<ul>
<li>Arg, <code>Conj</code>, <code>Im</code>, <code>Mod</code>, <code>Re</code></li>
</ul></li>
</ul>
<p>Apesar não termos funções com nomes <code>Math</code>, <code>Ops</code>, <code>Summary</code> e <code>Complex</code> no pacote <code>base</code>, e portanto, também não serem objetos <code>R</code>, podemos fornecer métodos para estes, como por exemplo, no pacote <code>base</code>, temos métodos como:</p>
<ul>
<li>Métodos de <code>Math</code>:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/methods.html'>methods</a></span><span class='op'>(</span><span class='st'>"Math"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] Math,CsparseMatrix-method  Math,ddenseMatrix-method  
 [3] Math,denseMatrix-method    Math,dgeMatrix-method     
 [5] Math,diagonalMatrix-method Math,nonStructure-method  
 [7] Math,sparseMatrix-method   Math,sparseVector-method  
 [9] Math,structure-method      Math.data.frame           
[11] Math.Date                  Math.difftime             
[13] Math.factor                Math.POSIXt               
[15] Math.quosure*              Math.vctrs_sclr*          
[17] Math.vctrs_vctr*          
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
<ul>
<li>Métodos de <code>Summary</code>:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/methods.html'>methods</a></span><span class='op'>(</span><span class='st'>"Summary"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] Summary,abIndex-method       Summary,ddenseMatrix-method 
 [3] Summary,ddiMatrix-method     Summary,dsparseMatrix-method
 [5] Summary,indMatrix-method     Summary,ldenseMatrix-method 
 [7] Summary,ldiMatrix-method     Summary,lMatrix-method      
 [9] Summary,Matrix-method        Summary,ndenseMatrix-method 
[11] Summary,nMatrix-method       Summary,nsparseVector-method
[13] Summary,sparseVector-method  Summary.data.frame          
[15] Summary.Date                 Summary.difftime            
[17] Summary.factor               Summary.numeric_version     
[19] Summary.ordered              Summary.POSIXct             
[21] Summary.POSIXlt              Summary.quosure*            
[23] Summary.roman*               Summary.unit*               
[25] Summary.vctrs_sclr*          Summary.vctrs_vctr*         
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
<ul>
<li>Métodos de <code>Complex</code>:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/methods.html'>methods</a></span><span class='op'>(</span><span class='st'>"Complex"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] Complex.vctrs_sclr*
see &#39;?methods&#39; for accessing help and source code</code></pre>
</div>
<p>Os métodos que estão com asterisco é porque não são exportados do namespace dos pacotes em que essas funções foram criadas. Para isso, use <code>:::</code>, <code>getS3method</code> ou <code>getAnywhere</code>. Por exemplo, se tentarmos procurar pelo método <code>str.data.frame</code> no console, não iremos encontrar porque ela não foi exportada pelo <em>namespace</em> do pacote <code>utils</code>. Para acessar o referido método, segue:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Primeira forma:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/getAnywhere.html'>getAnywhere</a></span><span class='op'>(</span><span class='st'>"str.data.frame"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>A single object matching &#39;str.data.frame&#39; was found
It was found in the following places
  registered S3 method for str from namespace utils
  namespace:utils
with value

function (object, ...) 
{
    if (!is.data.frame(object)) {
        warning(&quot;str.data.frame() called with non-data.frame -- coercing to one.&quot;)
        object &lt;- data.frame(object)
    }
    cl &lt;- oldClass(object)
    cl &lt;- cl[cl != &quot;data.frame&quot;]
    if (0 &lt; length(cl)) 
        cat(&quot;Classes&quot;, paste(sQuote(cl), collapse = &quot;, &quot;), &quot;and &quot;)
    cat(&quot;&#39;data.frame&#39;:\t&quot;, nrow(object), &quot; obs. of  &quot;, (p &lt;- length(object)), 
        &quot; variable&quot;, if (p != 1) 
            &quot;s&quot;, if (p &gt; 0) 
            &quot;:&quot;, &quot;\n&quot;, sep = &quot;&quot;)
    if (length(l &lt;- list(...)) &amp;&amp; any(&quot;give.length&quot; == names(l))) 
        invisible(NextMethod(&quot;str&quot;, ...))
    else invisible(NextMethod(&quot;str&quot;, give.length = structure(FALSE, 
        from = &quot;data.frame&quot;), ...))
}
&lt;bytecode: 0x0000000020bef428&gt;
&lt;environment: namespace:utils&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Segunda forma (Sistema S3 apenas):</span>
<span class='fu'><a href='https://rdrr.io/r/utils/getS3method.html'>getS3method</a></span><span class='op'>(</span><span class='st'>"str"</span>, <span class='st'>"data.frame"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>function (object, ...) 
{
    if (!is.data.frame(object)) {
        warning(&quot;str.data.frame() called with non-data.frame -- coercing to one.&quot;)
        object &lt;- data.frame(object)
    }
    cl &lt;- oldClass(object)
    cl &lt;- cl[cl != &quot;data.frame&quot;]
    if (0 &lt; length(cl)) 
        cat(&quot;Classes&quot;, paste(sQuote(cl), collapse = &quot;, &quot;), &quot;and &quot;)
    cat(&quot;&#39;data.frame&#39;:\t&quot;, nrow(object), &quot; obs. of  &quot;, (p &lt;- length(object)), 
        &quot; variable&quot;, if (p != 1) 
            &quot;s&quot;, if (p &gt; 0) 
            &quot;:&quot;, &quot;\n&quot;, sep = &quot;&quot;)
    if (length(l &lt;- list(...)) &amp;&amp; any(&quot;give.length&quot; == names(l))) 
        invisible(NextMethod(&quot;str&quot;, ...))
    else invisible(NextMethod(&quot;str&quot;, give.length = structure(FALSE, 
        from = &quot;data.frame&quot;), ...))
}
&lt;bytecode: 0x0000000020bef428&gt;
&lt;environment: namespace:utils&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Terceira forma</span>
<span class='fu'>utils</span><span class='fu'>:::</span><span class='va'><a href='https://rdrr.io/r/utils/str.html'>str.data.frame</a></span>
</code></pre>
</div>
<pre><code>function (object, ...) 
{
    if (!is.data.frame(object)) {
        warning(&quot;str.data.frame() called with non-data.frame -- coercing to one.&quot;)
        object &lt;- data.frame(object)
    }
    cl &lt;- oldClass(object)
    cl &lt;- cl[cl != &quot;data.frame&quot;]
    if (0 &lt; length(cl)) 
        cat(&quot;Classes&quot;, paste(sQuote(cl), collapse = &quot;, &quot;), &quot;and &quot;)
    cat(&quot;&#39;data.frame&#39;:\t&quot;, nrow(object), &quot; obs. of  &quot;, (p &lt;- length(object)), 
        &quot; variable&quot;, if (p != 1) 
            &quot;s&quot;, if (p &gt; 0) 
            &quot;:&quot;, &quot;\n&quot;, sep = &quot;&quot;)
    if (length(l &lt;- list(...)) &amp;&amp; any(&quot;give.length&quot; == names(l))) 
        invisible(NextMethod(&quot;str&quot;, ...))
    else invisible(NextMethod(&quot;str&quot;, give.length = structure(FALSE, 
        from = &quot;data.frame&quot;), ...))
}
&lt;bytecode: 0x0000000020bef428&gt;
&lt;environment: namespace:utils&gt;</code></pre>
</div>
<p>Os métodos desenvolvidos no pacote <code>base</code> com asterisco dos métodos genéricos de grupo não são acessados pelas funções anteriores. Por fim, vamos criar uma pequena rotina, adaptado de <span class="citation" data-cites="chambers2016"><a href="#ref-chambers2016" role="doc-biblioref">Chambers</a> (<a href="#ref-chambers2016" role="doc-biblioref">2016</a>)</span>, para vermos quais e quantas funções genéricas primitivas existem no pacote <code>base</code>, a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Todos os objetos do pacote 'base'</span>
<span class='va'>todosobj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ls.html'>objects</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/environment.html'>baseenv</a></span><span class='op'>(</span><span class='op'>)</span>, all.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>; 
<span class='co'># Mostre apenas os primeiros (ver todos remova 'head')</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>todosobj</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;-&quot;         &quot;-.Date&quot;    &quot;-.POSIXt&quot;  &quot;!&quot;         &quot;!.hexmode&quot;
[6] &quot;!.octmode&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Quantos objetos no pacote 'base'?</span>
<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>todosobj</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1373</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Quais sao funcoes primitivas?</span>
<span class='va'>objprimitivos</span> <span class='op'>&lt;-</span> <span class='va'>todosobj</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>todosobj</span>,  <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/is.function.html'>is.primitive</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='va'>x</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>baseenv</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>
<span class='co'># Mostre os primeiros (ver todos remova 'head')</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>objprimitivos</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;-&quot;   &quot;!&quot;   &quot;!=&quot;  &quot;$&quot;   &quot;$&lt;-&quot; &quot;%%&quot; </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Quantos primitivos ('buitin' ou 'special')?</span>
<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>objprimitivos</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 204</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Quais sao primitivos genéricos (Sistema S3)?</span>
<span class='va'>ehPrimitivaGenerica</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>primitiva</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>fprimitiva</span> <span class='op'>&lt;-</span> <span class='fu'>getFunction</span><span class='op'>(</span><span class='va'>primitiva</span>, mustFind <span class='op'>=</span> <span class='cn'>FALSE</span>, where <span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ns-internal.html'>asNamespace</a></span><span class='op'>(</span><span class='st'>"base"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>ehgenerica</span> <span class='op'>&lt;-</span> <span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/ftype.html'>ftype</a></span><span class='op'>(</span><span class='va'>fprimitiva</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>ehgenerica</span> <span class='op'>==</span> <span class='st'>"generic"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='cn'>TRUE</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='cn'>FALSE</span>
<span class='op'>}</span>
<span class='co'># Mostre os primeiros (ver todos remova 'head')</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>objprimitivos</span>, <span class='va'>ehPrimitivaGenerica</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    -     !    !=     $   $&lt;-    %% 
 TRUE FALSE  TRUE  TRUE  TRUE  TRUE </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Quantas sao primitivas genericas?</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>objprimitivos</span>, <span class='va'>ehPrimitivaGenerica</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 100</code></pre>
</div>
<h3 id="UseMethod">Entendendo melhor a chamada <code>UseMethod</code></h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/R0Ty5xjYDG4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>Na seção anterior, falamos que as funções genéricas do tipo <code>closure</code>, usam no corpo da função a chamada <code>UseMethod</code>. Esta é uma função primitiva, desenvolvida em <code>C</code>, porém usa a correspondência padrão de argumentos, com sintaxe dada por:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='va'>generic</span>, <span class='va'>object</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>em que o argumento <code>generic</code> representa o nome da função genérica (obrigatório para utilizar na chamada de <code>UseMethod</code>), e o segundo argumento <code>object</code> é o objeto cuja classe determina o método a ser enviado para execução pela função genérica. O argumento <code>objeto</code> representa o primeiro argumento da função genérica, e portanto, na prática usamos apenas o argumento <code>generic</code>, uma vez que a função <code>UseMethod</code> se encarrega do resto.</p>
<p>Uma outra coisa importante é que a chamada da função <code>UseMethod</code> deve ser usada apenas no corpo de uma função, isto é, <code>function(x) UseMethod("fgenerica")</code>. Caso contrário, ocorre o retorno de erro, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fgenerica</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"fgenerica"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Error in eval(expr, envir, enclos): &#39;função&#39; genérica não é uma função</code></pre>
</div>
<p>Desse modo, a forma correta de declarar a chamada de função <code>Usemethod</code>, baseado no exemplo anterior, deve ser apresentado como segue,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Primeira sintaxe</span>
<span class='va'>fgenerica</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"fgenerica"</span><span class='op'>)</span>
<span class='co'># Segunda sintaxe</span>
<span class='va'>fgenerica</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"fgenerica"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Terceira sintaxe</span>
<span class='va'>fgenerica</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"fgenerica"</span><span class='op'>)</span>
<span class='co'># Quarta sintaxe</span>
<span class='va'>fgenerica</span> <span class='op'>&lt;-</span> \<span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"fgenerica"</span><span class='op'>)</span>
<span class='op'>}</span> 
</code></pre>
</div>
</div>
<p>Portanto, o objeto associado ao nome <code>fgenerica</code> é o que chamamos de função genérica. Nesse caso, o código interno de <code>UseMethod</code> examina o atributo <code>class</code> no objeto do primeiro argumento da função genérica, que no caso da função genérica <code>fgenerica</code> anterior, é o argumento <code>x</code>.</p>
<p>A chamada <code>UseMethod</code> insere objetos especiais no ambiente de avaliação da função genérica, que são <code>.Class</code>, <code>.Generic</code> e <code>.Method</code>. Eles são responsáveis pelo despacho de método e os mecanismos de herança. O objeto <code>.Class</code> representa a classe do objeto (primeiro argumento da função genérica), <code>.Generic</code> é o nome da função genérica, e <code>.Method</code> é o nome do método usado. Poderá surgir também um outro objeto chamado <code>.Group</code>, quando funções genéricas são primitivas que se enquandram dentro das funções genéricas de grupo, visto mais a frente. De todo modo, isso é serviço para o <a href="http://r-project.org/" target="_blank">R</a> internamente e o usuário não precisará se preocupar. Vejamos o código a seguir, para observamos como podemos obter informações desses objetos.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>generico</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"generico"</span><span class='op'>)</span>

<span class='va'>generico.metodo</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"Imprima o valor dos objetos .Generic, .Class e .Method, respectivamente:\n"</span>, <span class='va'>.Generic</span>, <span class='st'>"\n"</span>, <span class='va'>.Class</span>, <span class='st'>"\n"</span>, <span class='va'>.Method</span><span class='op'>)</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>; <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"metodo"</span>
<span class='fu'>generico</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Imprima o valor dos objetos .Generic, .Class e .Method, respectivamente:
 generico 
 metodo 
 generico.metodo</code></pre>
</div>
<p>Uma coisa interessante, é que a função <code>UseMethod</code> por ser primitiva, não cria seu próprio ambiente, mas a sua chamada ocorre no ambiente de chamada, isto é, no ambiente de execução da função genérica. Além do mais, como o ambiente de chamada da função <code>UseMethod</code> é o ambiente de execução da função genérica, um código interno em <code>UseMethod</code> faz com que o ambiente de chamada seja finalizado após o método ter sido avaliado. Em outras palavras, o que for escrito no corpo da função genérica após a chamada <code>UseMethod</code>, não será executado nem avaliado. Vejamos um exemplo, para clarear o que estamos falando, que segue,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Funcao generica</span>
<span class='va'>quem</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Isso pode ser impresso!"</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"quem"</span><span class='op'>)</span>
  <span class='co'>## Apos a Chamada UseMethod o ambiente eh encerrado!</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Isso nao sera impresso!"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'>## Metodo</span>
<span class='va'>quem.eh</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Sou eu! (arg x)"</span><span class='op'>)</span>
<span class='co'># Aplicacao:</span>
<span class='va'>pessoa</span> <span class='op'>&lt;-</span> <span class='st'>"ben"</span> <span class='co'># objeto sem atributo 'class'</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>pessoa</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"eh"</span>
<span class='fu'>quem</span><span class='op'>(</span><span class='va'>pessoa</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Isso pode ser impresso!&quot;
[1] &quot;Sou eu! (arg x)&quot;</code></pre>
</div>
<p>Observemos nesse caso, que a linha de comando no corpo da função genérica <code>quem</code>, antes da chamada <code>UseMethod</code> é avaliada e executada, porém, o que ocorre após não é executado, uma vez, que não é impresso no console o resultado <code>"Isso nao sera impresso!"</code>. Logo, após a chamada de <code>UseMethod</code> e o envio de método para <code>quem.eh</code> e a ocorrência de sua execução, o ambiente de execução de <code>quem</code> é finalizado, do qual, <code>print("Isso nao sera impresso!")</code> não é executado.</p>
<h3 id="criando_fgenericas">Criando funções genéricas</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/FSZhTSo7U-U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>Como já mostrado em alguns exemplos na seção anterior, a forma de criar uma função genérica é por meio da inserção no corpo da criação de uma função, a chamada <code>UseMethod</code>. A ideia da função genérica, é encontrar o método específico para uma determinada instância de classe (objeto). Desse modo, criamos uma função genérica da seguinte forma:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Funcao generica</span>
<span class='va'>quem</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"quem"</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Assim, <code>quem</code> é uma função genérica. Esta função tem o objetivo, por meio de <code>UseMethod</code>, identificar a classe do objeto definido em <code>x</code>, e depois o envio de método, isto é, encontrar o método (objeto função) específico para a classe do objeto em <code>x</code>.</p>
<h3 id="classeS3">Classe e classe implícita</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/du32MYwxbsg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>Usuário de outras linguagens que estudaram POO , por exemplo em <em>Java</em>, <em>C++</em>, <em>Python</em>, devem estar muito confusos, até esse momento, como o sistema <strong>S3</strong> não tem uma forma usual de definir uma classe. Para isso, basta usar o atributo <code>class</code> em um objeto. Desse modo, este se torna uma instância da classe.</p>
<p>Já vimos no módulo básico como verificar os atributos em um objeto, por meio da função <code>attributes()</code>. Vamos expandir um pouco mais, antes de passarmos para o atributo <code>class</code>. Vejamos a seguir, como inserir um ou mais de um atributo aos objetos, bem como eliminá-los.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto</span>
<span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Inserindo atributos em um objeto (1ª Forma)</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>"dim"</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>5</span><span class='op'>)</span> <span class='co'># 1º Atributo 'dim'</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>"class"</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"ben"</span> <span class='co'># 2º Atributo 'ben'</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>"nada"</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"1"</span>  <span class='co'># 3º Atributo 'nada'</span>

<span class='co'># Visualizar os atributos em x</span>
<span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$dim
[1] 2 5

$class
[1] &quot;ben&quot;

$nada
[1] &quot;1&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Eliminando um determinado atributo ('nada')</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>"nada"</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span> <span class='co'># Remove atribuindo 'NULL'</span>

<span class='co'># Visualizar os atributos em x, sem o atributo 'nada'</span>
<span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$dim
[1] 2 5

$class
[1] &quot;ben&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Eliminar todos os atributos</span>
<span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>

<span class='co'># Visualizando x sem atributos</span>
<span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>NULL</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Inserindo os atributos todos de uma vez</span>
<span class='fu'>mostattributes</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>5</span><span class='op'>)</span>, class <span class='op'>=</span> <span class='st'>"ben"</span>, nada <span class='op'>=</span> <span class='st'>"1"</span><span class='op'>)</span>

<span class='co'># Verificando se um objeto apresenta determinado atributo, por exemplo, class='nada'</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>inherits</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"nada"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Outra forma de inserir mais de um atributo</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>5</span><span class='op'>)</span>, class <span class='op'>=</span> <span class='st'>"ben"</span>, nada <span class='op'>=</span> <span class='st'>"1"</span><span class='op'>)</span>

<span class='co'># Casos especificos, podem ter funcoes proprias</span>
<span class='co'># para inserir atributos, por exemplo, 'class'</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>"class"</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>; <span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='co'># removendo o atributo 'class'</span>
</code></pre>
</div>
<pre><code>$dim
[1] 2 5

$nada
[1] &quot;1&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"ben"</span>; <span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$dim
[1] 2 5

$nada
[1] &quot;1&quot;

$class
[1] &quot;ben&quot;</code></pre>
</div>
<p>Percebemos que alguns atributos têm funções próprias, além do atributo <code>class</code>, temos <code>dim</code>, <code>levels</code>, <code>names</code>, <code>dimnames</code>, dentre outros.</p>
<p>Para esse caso, iremos nos concentrar apenas no atributo <code>class</code>. Seguindo as próprias recomendações de <span class="citation" data-cites="hadley2019"><a href="#ref-hadley2019" role="doc-biblioref">Wickham</a> (<a href="#ref-hadley2019" role="doc-biblioref">2019</a>)</span>, e com razão, podemos utilizar qualquer conjunto de caracteres para nominar a classe de interesse. Porém, evitemos utilizar o ponto (“.”) como parte dos caracteres para nominar a classe, porque na próxima seção, veremos que o ponto é parte sintática da criação de um método, em que nominamos o método pela junção do nome da função genérica mais o nome da classe, separados por um ponto. E para evitar confusão, seguiremos essa sugestão.</p>
<p>Desse modo, poderemos retirar um objeto como instância de uma classe, removendo o atributo <code>class</code>. Essa flexibilidade na prática, não apresenta grandes problemas, um vez que como afirmado por <span class="citation" data-cites="hadley2019"><a href="#ref-hadley2019" role="doc-biblioref">Wickham</a> (<a href="#ref-hadley2019" role="doc-biblioref">2019</a>)</span>, o R não impede do programador atirar no próprio pé, desde que ele não aponte a arma para o pé e puxe o gatilho. Mais a frente, apresentaremos algumas sugestões propostas por <span class="citation" data-cites="hadley2019"><a href="#ref-hadley2019" role="doc-biblioref">Wickham</a> (<a href="#ref-hadley2019" role="doc-biblioref">2019</a>)</span>, do qual adotaremos.</p>
<p>Uma outra característica do atributo <code>class</code> é que este pode ser um vetor de caracteres. Por exemplo, um vetor atômico do tipo fator é largamente utilizado na estatística, quando queremos representar os níveis de um tratamento, em que para usar a função <code>aov()</code>, função para a realização da análise de variância, um dos argumentos da função faz-se necessário ser um fator. Em algumas situações, além de ser um fator, é importante que os níveis sejam ordenados, na estatística descritiva, chamamos também de variáveis qualitativas ordinais.</p>
<p>Para criarmos um vetor do tipo fator, usamos a função <code>factor</code>, e a sua ordenação, ou usamos em <code>factor</code>, o argumento <code>ordered=TRUE</code>, ou criamos um fator ordenado pela função <code>ordered()</code>. Usando este último, e associando a um nome, vamos perceber que o atributo <code>class</code> desse objeto é um vetor de comprimento 2, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto e sua classe</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;ordered&quot; &quot;factor&quot; </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Observando os atributos do objeto</span>
<span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$levels
[1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;

$class
[1] &quot;ordered&quot; &quot;factor&quot; </code></pre>
</div>
<p>Essa sequência será responsável pelo <strong>mecanismo de herança</strong> de métodos, que discutiremos mais a frente. No entanto, quando o objeto em <a href="http://r-project.org/" target="_blank">R</a> não é objeto POO, a função <code>class</code> pode retornar resultados equivocados quanto ao despacho do método. Por exemplo, vamos criar um vetor multidimensional, do tipo <code>array</code>, e verificarmos o que a função <code>class</code> retorna,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto e sua classe</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;matrix&quot; &quot;array&quot; </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Observando os atributos do objeto</span>
<span class='fu'><a href='https://rdrr.io/r/base/attributes.html'>attributes</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$dim
[1] 2 4</code></pre>
</div>
<p>Porém, usando a função <code>sloop::s3_class()</code> ou <code>.class2</code>, perceberemos uma maior detalhamento, observemos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_class.html'>s3_class</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;matrix&quot;  &quot;integer&quot; &quot;numeric&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/class.html'>.class2</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;matrix&quot;  &quot;array&quot;   &quot;integer&quot; &quot;numeric&quot;</code></pre>
</div>
<p>Isso é o que chamamos de <strong>classes implícitas</strong> aos objetos base, que não tem o atributo <code>class</code> definido. Segundo <span class="citation" data-cites="hadley2019"><a href="#ref-hadley2019" role="doc-biblioref">Wickham</a> (<a href="#ref-hadley2019" role="doc-biblioref">2019</a>)</span>, a <strong>classe implícita</strong>, obtida de objetos base, apresenta um vetor de três conjuntos de caracteres (<em>strings</em>):</p>
<ul>
<li><code>array</code> ou <code>matrix</code>, se o objeto tiver dimensão;</li>
<li>resultado de <code>typeof</code>, com algumas variações;</li>
<li><code>numeric</code>, se os valores forem <code>integer</code> (inteiro) ou <code>double</code> (real).</li>
</ul>
<p>Para mostrarmos que a função <code>class</code> não retorna corretamente o <strong>despacho de método</strong> utilizado, isto é, para qual método a chamada da função genérica (<code>UseMethod</code>) foi executado, vamos utilizar a função <code>sloop::s3_dispatch()</code>. O despacho ocorrerá no método que contém (<code>=&gt;</code>). Vejamos,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Imprimindo o despacho do objeto associado a 'y'</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   print.matrix
   print.integer
   print.numeric
=&gt; print.default</code></pre>
</div>
<p>Observe que o despacho ocorreu em <code>print.default</code>. O que fica mais claro, nesse segundo exemplo, o que queremos afirmar,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto com classe implícita (sem atributo 'class')</span>
<span class='va'>w</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='co'># Imprimindo class</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>w</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;numeric&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Verificando o despacho em 'print'</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>w</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   print.double
   print.numeric
=&gt; print.default</code></pre>
</div>
<p>Observemos nesse caso que <code>class</code> retorna <code>numeric</code>, e o despacho ocorre em <code>print.default</code>, e não em <code>print.numeric</code> como verificado por <code>class</code>, ficando mais evidente o que falamos anteriormente. Na seção <a href="#envio-herança">envio de método e mecanismos de herança</a>, detalharemos um pouco mais sobre o assunto.</p>
<p>Por fim, um último ponto que queríamos abordar são os termos técnicos como <strong>subclasse</strong> e <strong>superclasse</strong>. Anteriormente, vimos o objeto <code>x &lt;- ordered(1:5)</code> que era um fator ordenado, e que o seu atributo <code>class</code> era um vetor de comprimento 2, isto é, <code>"ordered" "factor"</code>. Dizemos que <code>"ordered"</code> é uma subclasse de <code>"factor"</code> porque o antecede no vetor, assim como <code>"factor"</code> é considerada uma superclasse para <code>"ordered"</code> porque o precede. A rigor, o sistema <strong>S3</strong> não faz imposição nenhuma a estas classes, mas veremos na seção <a href="#envio-herança">envio de método e mecanismos de herança</a>, algumas estratégias para isso.</p>
<h3 id="metodoS3">Método S3</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/LLhaVWuYIoE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>O método no sistema S3 tem a seguinte estrutura no nome da função <code>'nome_funcao_generica'.'nome_classe'</code>. Vamos supor que criamos uma classe para o objeto <code>pessoa</code>, com atributo <code>class</code> sendo <code>eh</code>, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto</span>
<span class='va'>pessoa</span> <span class='op'>&lt;-</span> <span class='st'>"ben"</span>
<span class='co'># Atribuindo classe ao objeto 'pessoa'</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>pessoa</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"eh"</span>
</code></pre>
</div>
</div>
<p>Como falado no <a href="nbasico.html">módulo básico</a>, os atributos não modificam os valores dos objetos. Então até aqui, nada de novo. Para criarmos o método, baseado na função genérica <code>quem</code>, criada anteriormente, e na classe <code>eh</code>, criamos um método (objeto de modo <code>function</code> no <code>R</code>, ou tipo <code>closure</code>) <code>quem.eh</code>, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## Metodo</span>
<span class='va'>quem.eh</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Sou eu!"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Algo muito importante no método é que a função deve ter os mesmos argumentos da função genérica, a menos que seja utilizado o objeto <code>...</code> na função genérica. De um modo geral, apresentamos alguns aspectos e sugestões para a criação de um método, que destacamos:</p>
<ul>
<li>Um método deve ser criado considerando a existência de uma função genérica ou uma classe;</li>
<li>O método deve apresentar os mesmos argumentos que a função genérica, e estes não se alteram no código interno da função genérica. Caso a função genérica apresente o objeto <code>'...'</code>, o número de argumentos entre a função genérica e o método podem ser diferentes;</li>
<li>Reforçando, evitem nos nomes das funções genéricas ou classes o uso de pontos, porque o ponto é uma forma sintática de criarmos o nome do método, isso evitará problemas para o despacho correto. Um exemplo é a função <code>t.test</code>, que poderíamos imaginar que fosse um método, em que <code>t</code> é a função genérica e <code>test</code> a classe. Na realidade, <code>t.test</code> é uma função genérica, pois usa a chamada <code>UseMethod</code>. A criação desse objeto o <a href="http://r-project.org/" target="_blank">R</a> deve ter ocorrido, muito provavelmente, antes da implementação do sistema S3 a base do <a href="http://r-project.org/" target="_blank">R</a>;</li>
<li>A chamada de função deve ser realizada, preferencialmente pela função genérica, porém nada impede de ser realizada pelo próprio método. Nesse caso, ocorrem alguns aspectos internos ao código, que chamaremos atenção mais a frente;</li>
<li>Na criação de funções genéricas em pacotes, deem preferências ao nome das classes exatamente igual ao nome do pacote em desenvolvimento. Isso evitará possíveis conflitos de nomes de classes;</li>
</ul>
<p>Finalizado a criação do método, o que ocorrerá agora é que não precisaremos chamar o método pelo próprio método, mas pela função genérica, é o que chamamos de <strong>envio de método</strong> (ou <strong>despacho de método</strong>). Essa é a caixa preta da POO, devemos acreditar que isso ocorrerá, claro, se todo o processo de criação estiver correto.</p>
<p>Um outro método que se sugere criar é o padrão (<code>default</code>), para que se a função genérica não encontrar o método específico, ela procurará pelo método padrão. Se não existir o método padrão, caso não encontre o método específico, a função genérica pode retornar uma mensagem de erro. Vejamos a implementação, a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto</span>
<span class='va'>pessoa</span> <span class='op'>&lt;-</span> <span class='st'>"ben"</span>
<span class='co'># Atribuindo classe ao objeto 'pessoa'</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>pessoa</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"eh"</span>
<span class='co'>## Metodo 'eh'</span>
<span class='va'>quem.eh</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Sou eu!"</span><span class='op'>)</span>
<span class='co'>## Metodo 'padrao'</span>
<span class='va'>quem.default</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"??"</span><span class='op'>)</span>
<span class='co'>#-----------------------------------------</span>
<span class='co'># Aplicacao:</span>
<span class='va'>pessoa</span> <span class='op'>&lt;-</span> <span class='st'>"ben"</span> <span class='co'># objeto sem atributo 'class'</span>
<span class='co'># Usando a funcao generica</span>
<span class='fu'>quem</span><span class='op'>(</span><span class='va'>pessoa</span><span class='op'>)</span> <span class='co'># Aplicando o metodo padrao</span>
</code></pre>
</div>
<pre><code>[1] &quot;??&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#--------</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>pessoa</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"eh"</span>
<span class='fu'>quem</span><span class='op'>(</span><span class='va'>pessoa</span><span class='op'>)</span> <span class='co'># Aplicando o metodo eh</span>
</code></pre>
</div>
<pre><code>[1] &quot;Sou eu!&quot;</code></pre>
</div>
<p>Retornando sobre a função <code>UseMethod</code>, quando inserimos os dois argumentos <code>generic</code> e <code>object</code> no corpo da função genérica, e definimos em <code>object</code> qual o objeto que a função observará o atributo <code>class</code>, a chamada de função <code>UseMethod</code> desconsiderará o primeiro argumento da função genérica, independente de ter um atributo <code>class</code> ou não. Vejamos um exemplo,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Funcao generica</span>
<span class='va'>quem</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"quem"</span>, <span class='va'>x</span><span class='op'>)</span>
<span class='co'># Metodos</span>
<span class='va'>quem.eh</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Sou eu!"</span><span class='op'>)</span>
<span class='va'>quem.outro</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Outro!"</span><span class='op'>)</span>
<span class='va'>quem.default</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Qualquer um!"</span><span class='op'>)</span>
<span class='co'># Objeto em UseMethod sem o atributo 'class'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='st'>"ben"</span>
<span class='co'># Objeto no primeiro argument de fgenerica</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='st'>"ninguem"</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"outro"</span>
<span class='co'># O despacho ocorre em quem.default</span>
<span class='fu'>quem</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Qualquer um!&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Removendo quem.defaul, a fgenerica retorna erro</span>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='st'>"quem.default"</span><span class='op'>)</span>; <span class='fu'>quem</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Error in UseMethod(&quot;quem&quot;, x): método não aplicável para &#39;quem&#39; aplicado a um objeto de classe &quot;character&quot;</code></pre>
</div>
<p>Contudo, se o objeto definido em <code>object</code> não tiver o atributo <code>class</code>, e não houver um despacho para o método <code>fgenerica.default</code>, a função genérica (<code>fgenerica</code>) retorna um erro. Vejamos outro exemplo,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>quem</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"quem"</span>, <span class='va'>x</span><span class='op'>)</span>
<span class='va'>quem.eh</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Sou eu!"</span><span class='op'>)</span>
<span class='va'>quem.outro</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Outro!"</span><span class='op'>)</span>
<span class='va'>quem.default</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Qualquer um!"</span><span class='op'>)</span>

<span class='co'># Objeto em UseMethod</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='st'>"ben"</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"eh"</span>
<span class='co'># Objeto no primeiro argument de fgenerica</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='st'>"ninguem"</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"outro"</span>
<span class='co'># Executando a funcao generica</span>
<span class='fu'>quem</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Sou eu!&quot;</code></pre>
</div>
<p>Uma coisa interessante que ocorre com a chamada <code>UseMethod</code>, que foge a exceção do padrão de chamadas das funções. Vejamos o código a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Funcao (Primeiro caso)</span>
<span class='va'>h</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='fu'>h</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> x  y 
10 10 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#----------------------------------------</span>
<span class='co'># Funcao generica e metodo (Segundo caso)</span>
<span class='va'>g</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"g"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># metodo padrao</span>
<span class='va'>g.default</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>
<span class='co'># Avaliacao</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='fu'>g</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>x y 
1 1 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#----------------------------------------</span>
<span class='co'># Funcao generica e metodo (Terceiro caso)</span>
<span class='va'>g</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"g"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># metodo padrao</span>
<span class='va'>g.default</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>
<span class='co'># Avaliacao</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='fu'>g</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> x  y 
 1 10 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#-----------------------------------------</span>
<span class='co'># Funcao generica e metodo (Quarto caso)</span>
<span class='va'>g.default</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>
<span class='co'># Avaliacao</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='fu'>g.default</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>x y 
1 1 </code></pre>
</div>
<p>Observemos no primeiro caso, em que definimos duas variáveis globais <code>x &lt;- 1</code> e <code>y &lt;- 1</code>, ao serem utilizadas como argumentos da função <code>h()</code>, percebemos que após a chamada de <code>h()</code>, o ambiente de execução é criado temporariamente, e lá existe três instâncias <code>x &lt;- 10</code>, <code>y &lt;- 10</code> e a chamada <code>c(x = x, y = y)</code>, em que esta última busca por <code>x</code> e <code>y</code>, que é encontrado nas duas instâncias anteriores, e que portanto, sobrepõe a entrada dos argumentos. Logo, o resultado de <code>h(x, y)</code> será um vetor de comprimento 2, com valores 10 e 10, respectivamente.</p>
<p>No segundo caso, temos uma função genérica, e aqui surge algo meio inconsistente, aparentemente com a chamada <code>UseMethod</code> no corpo da função genérica. Mais vez, esta função nos surpreende, porque ela não permite a alteração dos argumentos definidos na função genérica com variáveis definidas no código interno dessa função, para posteriormente, seguir no despacho do método. Observemos na função genérica<code>g()</code>, que apesar de associado valores para os nomes <code>x</code> e <code>y</code>, todos iguais a <code>10</code>, ao chamarmos <code>g()</code>, definimos para os seus argumentos <code>x</code> e <code>y</code> valores iguais a <code>1</code>, e o que ocorre após a chamada dessa função é um vetor de <code>1s</code> (uns). Isto siginifica, que as instâncias internas da função genérica, não alteraram os argumentos da função, e o despacho de método segue para <code>g.default()</code>.</p>
<p>No terceiro caso, a função genérica apresenta apenas um argumento, <code>x</code>. Observemos nesse caso, que o código interno do método <code>g.default()</code> procura por um objeto associado a <code>y</code>, que é encontrado primeiro no ambiente de execução da função genérica, cujo resultado é <code>10</code>. Porém, mesmo havendo um nome <code>x</code> associado ao valor <code>10</code>, no ambiente de execução da função genérica, a chamada <code>UseMethod</code> preserva o argumento <code>x = 1</code> definido em <code>g()</code>, que despacha para o método. Ao final, o resultado da função genérica é um vetor com valores <code>1</code> e <code>10</code>, respectivamente.</p>
<p>Por fim, o quarto caso, cuja a chamada de função ocorre diretamente pelo método e não pela função genérica. Nesse caso, o resultado será igual ao que ocorre com a função <code>h()</code>, porque não há o despacho pela chamada <code>UseMethod</code>, e portanto, não se preserva os argumentos da função no código interno da função genérica.</p>
<p>Retornando a criação de métodos, uma forma de criar um método é por meio de <strong>funções primitivas genéricas</strong>. No fim da seção <a href="#funcoes_genericas">Funções genéricas</a>, mostramos um código como encontrar as funções primitivas genéricas. O procedimento será o mesmo, isto é, determinado a função genérica, por exemplo, <code>print</code>, e posteriormente, definir uma classe específica para um objeto. Vamos implementar um método para <code>print</code>, a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto classe 'comp'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>; <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"comp"</span>
<span class='co'># Metodo 'comp'</span>
<span class='va'>print.comp</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>unclass</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"O comprimento de "</span>, <span class='va'>x</span>, <span class='st'>" eh "</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Aplicacao</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='co'># Metodo 'comp'</span>
</code></pre>
</div>
<pre><code>O comprimento de  1 2 3 4 5 6 7 8 9 10  eh  10</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>unclass</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Metodo 'defaut'</span>
</code></pre>
</div>
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<p>Além de as funções internas/primitivas não terem a chamada <code>UseMethod</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, que podem dificultar a identificação de uma função genérica, alguns de seus métodos não estão exportadas pelo <em>namespace</em> do pacote base. Para verificarmos o código interno (instruções) desses métodos, podemos usar três funções: <code>:::</code>, <code>getS3method</code> ou <code>getAnywhere</code>, já comentados na seção <a href="#fgenericas">Funções genéricas</a>.</p>
<p>Podemos usar a função <code>utils::methods()</code>, <code>sloop::s3_methods_generic()</code> ou <code>sloop::s3_methods_class()</code>. Com essas, funções podemos saber por meio do nome ou da função genérica ou pelo nome da classe, quais os métodos disponíveis. Vejamos pelo código a seguir, por exemplo usando a função genérica <code>print</code>, quais os métodos disponíveis, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Usando o nome da funcao generica</span>
<span class='co'># utils::methods(print) </span>
<span class='co'>##  [1] print.acf*                        </span>
<span class='co'>##  [2] print.AES*                        </span>
<span class='co'>##  [3] print.all_vars*                   </span>
<span class='co'>##  [4] print.anova*                      </span>
<span class='co'>##  [5] print.ansi_string*                </span>
<span class='co'>##  [6] print.ansi_style* </span>
<span class='co'>##  ...</span>
<span class='co'># Usando agora a funcao s3_methods_generic</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_methods_class.html'>s3_methods_generic</a></span><span class='op'>(</span><span class='st'>"print"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 306 x 4
   generic class    visible source             
   &lt;chr&gt;   &lt;chr&gt;    &lt;lgl&gt;   &lt;chr&gt;              
 1 print   acf      FALSE   registered S3method
 2 print   AES      FALSE   registered S3method
 3 print   all_vars FALSE   registered S3method
 4 print   anova    FALSE   registered S3method
 5 print   any_vars FALSE   registered S3method
 6 print   aov      FALSE   registered S3method
 7 print   aovlist  FALSE   registered S3method
 8 print   ar       FALSE   registered S3method
 9 print   Arima    FALSE   registered S3method
10 print   arima0   FALSE   registered S3method
# ... with 296 more rows</code></pre>
</div>
<p>Observamos, pelos pacotes instalados no computador do qual escrevemos esse material, apresenta para a função genérica <code>print</code>, 284 métodos. Porém, observamos que a última função <code>sloop::s3_methods_generic()</code> apresenta um maior detalhamento dos métodos, como por exemplo, a visibilidade de suas instruções no <em>console</em>, e ainda de qual pacote o método foi desenvolvido. Nesse caso, quando na coluna <em>visible</em>, um determinado método retorna <code>FALSE</code>, que é equivalente a um asterisco no resultado, por meio da função <code>methods()</code>, que significa que o método não é exportado do <em>namespace</em> do pacote, em que esse método foi desenvolvido. Contudo, mostramos anteriormente, alternativas de como acessar esses métodos.</p>
<p>De outro modo, poderíamos está interessados em métodos baseados em uma determinada classe. Nesse caso, vejamos um exemplo para a classe <code>factor</code>, a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Usando o nome da funcao generica</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/methods.html'>methods</a></span><span class='op'>(</span>class <span class='op'>=</span> <span class='va'>factor</span><span class='op'>)</span> <span class='co'># Imprimindo os primeiros metodos para a classe 'factor'</span>
</code></pre>
</div>
<pre><code> [1] [             [[            [[&lt;-          [&lt;-          
 [5] all.equal     Arith         as.character  as.data.frame
 [9] as.Date       as.list       as.logical    as.POSIXlt   
[13] as.vector     c             cbind2        coerce       
[17] Compare       droplevels    format        initialize   
[21] is.na&lt;-       length&lt;-      levels&lt;-      Logic        
[25] Math          Ops           plot          print        
[29] rbind2        relevel       relist        rep          
[33] show          slotsFromS3   summary       Summary      
[37] xtfrm        
see &#39;?methods&#39; for accessing help and source code</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Usando agora a funcao s3_methods_generic</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_methods_class.html'>s3_methods_class</a></span><span class='op'>(</span><span class='st'>"factor"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 28 x 4
   generic       class  visible source
   &lt;chr&gt;         &lt;chr&gt;  &lt;lgl&gt;   &lt;chr&gt; 
 1 [             factor TRUE    base  
 2 [[            factor TRUE    base  
 3 [[&lt;-          factor TRUE    base  
 4 [&lt;-           factor TRUE    base  
 5 all.equal     factor TRUE    base  
 6 as.character  factor TRUE    base  
 7 as.data.frame factor TRUE    base  
 8 as.Date       factor TRUE    base  
 9 as.list       factor TRUE    base  
10 as.logical    factor TRUE    base  
# ... with 18 more rows</code></pre>
</div>
<p>Para o caso dos <strong>genéricos de grupo</strong>, sabemos que os grupos <code>Math</code>, <code>Ops</code>, <code>Summary</code>, e <code>Complex</code> não são objetos <code>R</code>, porém esses nomes podem ser usados para a criação de métodos S3. Uma outra coisa interessante nessa situação é que os objetos <code>.Generic</code>, <code>.Class</code> e <code>.Methods</code>, sofrem uma pequena variação da forma convencional dos nomes da função genérica, da classe e do método, respectivamente. Vamos tomar como exemplo a função <code>sum()</code> que pertence ao grupo <code>Summary</code>, e vamos criar um método para o grupo <code>Summary</code>, a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Metodo ben</span>
<span class='va'>Summary.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>.Generic</span>, <span class='va'>.Class</span>, <span class='va'>.Method</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Vamos aplicar a funcao sum em um obj de classe 'ben'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>1</span>, class <span class='op'>=</span> <span class='st'>"ben"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;sum&quot;         &quot;ben&quot;         &quot;Summary.ben&quot;</code></pre>
</div>
<p>Observamos nesse primeiro exemplo que o objeto <code>.Generic</code> acaba recebendo o nome da função genérica do grupo e não o nome do grupo, como poderíamos pensar. Porém, o nome do método acaba sendo relacionado com o nome do grupo e não da função genérica aplicada, nesse caso. No que isso interfere na semântica do sistema S3? Tudo! Vejamos um outro exemplo, com o código a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Metodo</span>
<span class='va'>Summary.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='st'>"Eu sou do grupo 'Summary'"</span>
<span class='op'>}</span>
<span class='co'># Objeto de classe 'ben'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>2</span>, class <span class='op'>=</span> <span class='st'>"ben"</span><span class='op'>)</span>
<span class='co'># Genericos do grupo 'Summary'</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;&quot;</code></pre>
</div>
<p>Como criamos o método a partir do nome do grupo, todas as funções genéricas desse grupo despacharão nesse método, e o resultado para todas as funções será o mesmo. Um outro recurso, seria utilizar a função <code>switch()</code> para diferenciar o despache de método, apesar desse envio ser no próprio <code>Summary.ben()</code>. Vejamos o próximo código para esse elucidar o que acabamos de falar.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Metodo</span>
<span class='va'>Summary.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span><span class='va'>.Generic</span>,
         all <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Eu sou do grupo 'Summary', mas generico: "</span>, <span class='va'>.Generic</span><span class='op'>)</span>,
         any <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Eu sou do grupo 'Summary', mas generico: "</span>, <span class='va'>.Generic</span><span class='op'>)</span>,
         sum <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Eu sou do grupo 'Summary', mas generico: "</span>, <span class='va'>.Generic</span><span class='op'>)</span>,
         prod <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Eu sou do grupo 'Summary', mas generico: "</span>, <span class='va'>.Generic</span><span class='op'>)</span>,
         min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Eu sou do grupo 'Summary', mas generico: "</span>, <span class='va'>.Generic</span><span class='op'>)</span>,
         max <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Eu sou do grupo 'Summary', mas generico: "</span>, <span class='va'>.Generic</span><span class='op'>)</span>,
         range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Eu sou do grupo 'Summary', mas generico: "</span>, <span class='va'>.Generic</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='op'>}</span>
<span class='co'># Objeto de classe 'ben'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>2</span>, class <span class='op'>=</span> <span class='st'>"ben"</span><span class='op'>)</span>
<span class='co'># Genericos do grupo 'Summary'</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;, mas generico: all&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;, mas generico: any&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;, mas generico: sum&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;, mas generico: prod&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;, mas generico: min&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;, mas generico: max&quot;</code></pre>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;, mas generico: range&quot;</code></pre>
</div>
<p>Ou ainda, poderíamos ter criado um método apenas para uma função genérica específica do grupo. Desse modo, não criamos o método a partir do nome do grupo, mas da própria função. Vejamos o próximo código.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Metodo para o generico 'min'</span>
<span class='va'>min.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span> <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Eu sou do grupo 'Summary', mas generico: "</span>, <span class='va'>.Generic</span><span class='op'>)</span>
<span class='co'># Objeto de classe 'ben'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>2</span>, class <span class='op'>=</span> <span class='st'>"ben"</span><span class='op'>)</span>
<span class='co'># Generico do grupo 'Summary': min()</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Eu sou do grupo &#39;Summary&#39;, mas generico: min&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Ja com um outro generico de 'Summary', o resultado eh diferente</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2</code></pre>
</div>
<p>Uma vez entendido a criação de método, vamos entender na sequência, os detalhes que a chamada <code>UseMethod()</code> realiza para o envio de método e os mecanismos de herança e como esse processo ocorre para as funções genéricas primitivas e os grupos genéricos, que não apresentam a chamada <code>UseMethod()</code> en seu código interno.</p>
<h3 id="envio-herança">Envio de método e mecanismo de herança</h3>
<p>Como falado anteriormente, o atributo <code>class</code> em um objeto, pode ser um vetor de <code>strings</code>, e ter diversos nomes. Já comentamos anteriormente sobre o <strong>envio de método</strong> ou também podemos chamar como <strong>despacho de método</strong>.</p>
<h4 id="envio-ou-despacho-de-método">Envio ou despacho de método</h4>
<p>A ideia do envio de método e a criação de um vetor de potenciais nomes de métodos, como por exemplo esse:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"generic"</span>, <span class='st'>"."</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='st'>"default"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;generic.integer&quot; &quot;generic.default&quot;</code></pre>
</div>
<p>E desse modo a chamada <code>UseMethod</code> se encarregará de verificar quais os métodos que existem. Pode haver mais de uma existência de método, será chamado o primeiro método na sequência de métodos existentes. Para verificar isso, podemos usar a função <code>sloop::s3_dispatch()</code>, isto é,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto de classe 'data.frame'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span> 
<span class='co'># Despacho (envio) do generico 'print'</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>=&gt; print.data.frame
 * print.default</code></pre>
</div>
<p>O resultado da chamada <code>sloop::s3_dispatch()</code> pode apresentar três símbolos antes dos potenciais nomes de métodos:</p>
<ul>
<li><code>=&gt;</code>: este símbolo indica que a função genérica despachou no referido método;</li>
<li><code>*</code>: este símbolo indica que este método existe, mas a função genérica não despachou nele;</li>
<li><code>-&gt;</code>: indica o método chamado subjacente, após o método com o símbolo <code>=&gt;</code> ter sido chamado. Isso ocorre, por no método representado por <code>"=&gt;"</code> existe uma função nominada por <code>NextMethod</code> que faz o serviço de chamar o próximo método. Veremos esse ponto mais a frente.</li>
</ul>
<p>No código anterior, vimos os dois símbolos <code>=&gt;</code> e <code>*</code>. Interpretamos que a função genérica <code>print(x)</code> despachou em <code>print.data.frame()</code>, mas que o método <code>print.default</code> existia, porém não foi utilizado.</p>
<p>Vejamos o próximo código para entendermos o que significa o símbolo (<code>-&gt;</code>) na saída da função <code>sloop::s3_dispatch()</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Funcao generica</span>
<span class='va'>quem_sou_eu</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"quem_sou_eu"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Metodo numero natural</span>
<span class='va'>quem_sou_eu.numero_natural</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"Eu sou um numero natural"</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></span><span class='op'>(</span><span class='st'>"quem_sou_eu"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Metodo numerico</span>
<span class='va'>quem_sou_eu.numerico</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"Eu sou numerico"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>

<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"numero_complexo"</span>,<span class='st'>"numero_natural"</span>,<span class='st'>"numerico"</span><span class='op'>)</span>

<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'>quem_sou_eu</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   quem_sou_eu.numero_complexo
=&gt; quem_sou_eu.numero_natural
-&gt; quem_sou_eu.numerico
   quem_sou_eu.default</code></pre>
</div>
<p>Observemos que a função genérica <code>quem_sou_eu()</code> despachou no método <code>quem_sou_eu.numero_natural</code>, símbolo (<code>=&gt;</code>), mas internamente nesse método, nós temos a chamada <code>NextMethod()</code> que invoca o próximo método. Nesse caso foi <code>quem_sou_eu.numerico</code>, com o símbolo (<code>-&gt;</code>). Os demais métodos não existem, pois não apresentam o asterisco (<code>*</code>). Entenderemos um pouco mais sobre a chamada <code>NextMethod()</code> mais a frente.</p>
<h4 id="funções-primitivas-genéricas-e-genéricos-de-grupo">Funções primitivas genéricas e genéricos de grupo</h4>
<p>Anteriormente falamos sobre as funções primitivas genéricas. Dissemos que eram funções escritas em linguagem <code>C</code>, não apresentavam as três composições básicas de uma função: <code>formals()</code>, <code>body()</code>, <code>environment()</code>, e que não apresentavam internamente a chamada <code>UseMethod</code>. Então, se o objeto inserido no primeiro argumento dessas funções não tiverem o atributo <code>class</code> (objeto base), o despacho para métodos não ocorrerá, isto é, as funções primitivas genéricas não usarão as classes implícitas. Isso porque, as funções que se comportam de modo diferente para diferentes tipos de objetos base, apresentam essa característica não porque formam um sistema POO, mas porque estas funções primitivas usam instruções da linguagem <code>C</code> do tipo <code>switch</code>. Nós temos a versão da função <code>switch()</code> em <a href="http://r-project.org/" target="_blank">R</a>, e foi comentada no <a href="nbasico.html">módulo Básico</a>. Vejamos a função primitiva genérica <code>cbind()</code>, como exemplo a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Eh primitiva generica?</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/is_s3_generic.html'>is_s3_generic</a></span><span class='op'>(</span><span class='st'>"cbind"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Onde ocorre o despacho?</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   cbind.integer
   cbind.numeric
   cbind.default
=&gt; cbind (internal)</code></pre>
</div>
<!-- Entretanto, quando uso um atributo no argumento em cbind, o processo não ocorre quando faço o mesmo com a funcao length. Estudar depois essa ideia! Mandei essa duvida para o pacote sloop: -->
<!-- cbind.default <- function(x, ...) "Test!" -->
<!-- x <- 1:10 -->
<!-- sloop::s3_dispatch(cbind(structure(x, class = "numeric"))) -->
<!-- cbind(structure(x, class = "numeric")) -->
<!-- ##### -->
<!-- x <- matrix(1:6, nrow = 2) -->
<!-- sloop::s3_dispatch(print(x)) -->
<!-- length.default <- function(x) 10 -->
<!-- sloop::s3_dispatch(length(x)) -->
<!-- sloop::s3_dispatch(length(structure(x, class = "numeric"))) -->
<p>Percebemos nesse caso, como o objeto <code>1:10</code> não apresenta o atributo <code>class</code>, a função interna foi a chamada, e nenhuma das classes implícitas são utilizadas. Nesse caso, apenas função primitiva/interna é utilizada.</p>
<p>No caso dos <strong>genéricos de grupo</strong>, sabemos que o nome dos grupos podem fazer parte da criação do método e o despacho de todos os genéricos serão realizados nesse método. Mas também, podemos criar métodos específicos para um determinado genérico de um grupo, sem influenciar no despacho dos demais genéricos. Nesses casos, os genéricos de grupo procurarão inicialmente pelos métodos relacionados as funções primitivas genéricas (<code>fpgenerica.classe</code>), e não achando, procurará pelos métodos relacioado aos nomes dos grupos (<code>grupo.classe</code>), não achando, despachará na função primitiva. Pode haver também o mecanismo de herança, por meio da chamada <code>NextMethod()</code>. Vejamos o código a seguir para o primeiro caso.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto de classe factor</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
<span class='co'># Verificando o despacho de sqrt() do grupo 'Math'</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   sqrt.factor
   sqrt.default
=&gt; Math.factor
   Math.default
 * sqrt (internal)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Verificando o metodo Math.factor()</span>
<span class='va'>Math.factor</span>
</code></pre>
</div>
<pre><code>function (x, ...) 
stop(gettextf(&quot;%s not meaningful for factors&quot;, sQuote(.Generic)))
&lt;bytecode: 0x000000003f95d150&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
<p>Observamos nessa situação que o objeto do tipo <em>factor</em>, apesar de ser um resultado numérico, não se comporta como numérico. Nesse caso, calcular a raiz quadrado de cada elemento não será possível, ou qualquer outra operação do grupo <code>'Math'</code>, e assim, uma proteção para esse caso é assegurado logo no método <code>Math.factor()</code> (<code>=&gt;</code>) com a chamada <code>stop()</code>. A ideia da função <code>gettextf()</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> no ambiente <a href="http://r-project.org/" target="_blank">R</a>é similar a <code>printf()</code> para a linguagem <code>C</code>. No despacho, percebemos que existe a função primitiva (*) <code>sqrt()</code>, porém nesse caso, não foi utilizada.</p>
<p>Para os demais casos, podemos observar o código na sequência, para entermos o que falamos anteriormente.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Primeira situacao:</span>
<span class='co'># ------------------</span>
<span class='co'># Metodo de grupo</span>
<span class='va'>Summary.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='st'>"Eu despacho em todo grupo 'Summary'"</span>
<span class='op'>}</span>
<span class='co'># Objeto de classe 'ben'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, class <span class='op'>=</span> <span class='st'>"ben"</span><span class='op'>)</span>
<span class='co'># Despacho para funcao 'all'</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   all.ben
   all.default
=&gt; Summary.ben
   Summary.default
 * all (internal)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>####################</span>
<span class='co'># Segunda situacao:</span>
<span class='co'># ------------------</span>
<span class='co'># Metodo apenas para a funcao 'all'</span>
<span class='va'>all.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='st'>"Eu despacho apenas para 'all.ben'"</span>
<span class='op'>}</span>
<span class='co'># Metodo de grupo</span>
<span class='va'>Summary.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></span><span class='op'>(</span><span class='va'>.Generic</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Objeto de classe 'ben'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, class <span class='op'>=</span> <span class='st'>"ben"</span><span class='op'>)</span>
<span class='co'># Despacho para funcao 'all'</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>=&gt; all.ben
   all.default
 * Summary.ben
   Summary.default
 * all (internal)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>###################</span>
<span class='co'># Terceira situacao:</span>
<span class='co'># ------------------</span>
<span class='co'># Metodo apenas para a funcao 'all'</span>
<span class='va'>all.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></span><span class='op'>(</span><span class='va'>.Generic</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Metodo de grupo</span>
<span class='va'>Summary.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='st'>"Eu passei por 'all.ben', mas terminei em 'Summary.ben'"</span>
<span class='op'>}</span>
<span class='co'># Objeto de classe 'ben'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, class <span class='op'>=</span> <span class='st'>"ben"</span><span class='op'>)</span>
<span class='co'># Despacho para funcao 'all'</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>=&gt; all.ben
   all.default
-&gt; Summary.ben
   Summary.default
 * all (internal)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>###################</span>
<span class='co'># Quarta situacao:</span>
<span class='co'># ------------------</span>
<span class='co'># Metodo apenas para a funcao 'all'</span>
<span class='va'>all.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></span><span class='op'>(</span><span class='va'>.Generic</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Metodo de grupo</span>
<span class='va'>Summary.ben</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>na.rm</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></span><span class='op'>(</span><span class='va'>.Generic</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Objeto de classe 'ben'</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, class <span class='op'>=</span> <span class='st'>"ben"</span><span class='op'>)</span>
<span class='co'># Despacho para funcao 'all'</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>=&gt; all.ben
   all.default
-&gt; Summary.ben
   Summary.default
-&gt; all (internal)</code></pre>
</div>
<p>A primeira situação o envio de método ocorre para <code>Summary.ben()</code> (<code>=&gt;</code>), se verifica a função primita <code>all()</code> (<code>*</code>), porém não executada. Na segunda situação, observamos a existência do método <code>Summary.ben()</code> (<code>*</code>) e a função primitiva <code>all()</code> (<code>*</code>), porém o descpacho ocorre em <code>all.ben()</code> (<code>=&gt;</code>). Na terceira situação, o despacho ocorre em <code>all.ben()</code> (<code>=&gt;</code>), que intermanente chama <code>NextMethod()</code>, delegando para <code>Summary.ben()</code> (<code>-&gt;</code>). Por fim, na quarta situação o envio de método ocorre em <code>all.ben()</code> (<code>=&gt;</code>) que delega para <code>Summary.ben</code> (<code>-&gt;</code>), que delega para a função primitiva <code>all()</code> (<code>-&gt;</code>).</p>
<!-- #### Cuidado com as anomalias -->
<!-- Pela flexibilidade do sistema S3, devemos tomar alguns cuidados na cria.... -->
<!-- # Metodo para o generico 'min' (genericos de grupo) -->
<!-- max.ben <- function(x, ..., na.rm = FALSE) { -->
<!--   print(x) # O problema eh que print despacha em print.default -->
<!-- } -->
<!-- # Com isso resolve -->
<!-- # print.ben <- function(x) { -->
<!-- #   "Despachou em print.ben" -->
<!-- # } -->
<!-- # Objeto de classe 'ben' -->
<!-- x <- structure(2:5, class = "ben") -->
<!-- # Despacho -->
<!-- sloop::s3_dispatch(print(x)) -->
<!-- # Executando -->
<!-- max(x) # Problema -->
<!-- ### -->
<!-- # Generico -->
<!-- fgenerica <- function(x) UseMethod("fgenerica") -->
<!-- # Metodo -->
<!-- fgenerica.ben <- function(..., na.rm = FALSE) print("Test") -->
<!-- # Objeto de classe 'ben' -->
<!-- x <- structure(2:5, class = "ben") -->
<!-- # Despacho -->
<!-- sloop::s3_dispatch(fgenerica(x)) -->
<!-- # Executando -->
<!-- fgenerica(x) # Sem problemas -->
<h3 id="chamada-nextmethod">Chamada <code>NextMethod()</code></h3>
<p>Vimos anteriormente que a chamada <code>UseMethod()</code> é responsável pelo envio de método, isto é, dado um objeto com um atributo <code>class</code> inserido no primeiro argumento do genérico, a chamada <code>UseMethod()</code> procurará pelo método específico dessa classe. Contudo, falamos anteriormente, que o atributo <code>class</code> pode ser um vetor de caracteres. Dessa forma é que entra a chamada <code>NextMethod()</code>. A ideia é aplicar o genérico para o próximo método. Já mostramos anteriormente essa semântica, e vamos reforçar com o código a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Generico</span>
<span class='va'>fgenerica</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"fgenerica"</span><span class='op'>)</span>
<span class='co'># Metodo 1</span>
<span class='va'>fgenerica.clas1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Despache para o metodo 1"</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></span><span class='op'>(</span><span class='st'>"fgenerica"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Metodo 2</span>
<span class='va'>fgenerica.clas2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Despache para o metodo 2"</span><span class='op'>)</span>
<span class='co'>############</span>
<span class='co'># Avaliacao:</span>
<span class='co'># Objeto clas1 e clas2</span>
<span class='fu'>fgenerica</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>2</span>, class <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"clas1"</span>, <span class='st'>"clas2"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Despache para o metodo 1&quot;
[1] &quot;Despache para o metodo 2&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Objeto clas2</span>
<span class='fu'>fgenerica</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>2</span>, class <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"clas2"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Despache para o metodo 2&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Despacho</span>
<span class='fu'>sloop</span><span class='fu'>::</span><span class='fu'><a href='https://sloop.r-lib.org/reference/s3_dispatch.html'>s3_dispatch</a></span><span class='op'>(</span><span class='fu'>fgenerica</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>2</span>, class <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"clas1"</span>, <span class='st'>"clas2"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>=&gt; fgenerica.clas1
-&gt; fgenerica.clas2
   fgenerica.default</code></pre>
</div>
<p>O que caracteriza a chamada <code>NextMethod()</code> é a ocorrência do símbolo (<code>-&gt;</code>) na saída em <code>sloop::s3_dispatch()</code>. O que essa chamada de função faz é executar o próximo método.</p>
<p>De modo formal, apresentamos a sintaxe como <code>NextMethod(generic, object, ...)</code>. Se nenhum argumento for adionado em <code>NextMethod()</code>, os argumentos serão os mesmos em quantidade, ordem e nome do método corrente, e por consequência também dos argumentos do genérico. Outra coisa interessante é que por meio de <code>'...'</code>, podemos inserir mais argumentos para essa chamada, do qual todos os argumentos são anexados em uma lista como promessas, isto é, os argumentos não são avaliados. Porém se foram avaliados no ambiente atual ou no ambiente anterior, permanecerão avaliados. Vejamos alguns outros aspectos, dos quais alguns foram citados por <span class="citation" data-cites="chambers1993"><a href="#ref-chambers1993" role="doc-biblioref">Chambers and Hastie</a> (<a href="#ref-chambers1993" role="doc-biblioref">1993</a>)</span>:</p>
<ol type="1">
<li>Os argumentos são transmitidos do método corrente para o método herdado com seus valores atuais no momento em que <code>NextMethod()</code> é chamado;</li>
<li>Um objeto com mesmo nome de um dos argumentos (até mesmo o primeiro argumento) do método corrente, definido no ambiente de chamada de <code>NextMethod()</code>, pode ser passado para o método herdado, sendo um valor diferente definido no argumento do método corrente. No caso da chamada <code>UseMethod()</code>, é preservado o valor definido nos argumentos do genérico;</li>
<li>Alterar o primeiro argumento do genérico em uma chamada <code>NextMethod()</code> afeta os argumentos recebidos no método herdado, mas não na escolha desse método.</li>
<li>A avaliação preguiçosa dos argumentos continuam. Se um argumento não foi avaliado, continua não avaliado;</li>
<li>Argumentos ausentes permanecem ausentes no método herdado;</li>
<li>Alguns objetos definidos no método atual, se informados em <code>NextMethod()</code>, passarão para o método herdado, desde esse objeto seja um argumento do método herdado;</li>
<li>O ambiente de chamada de <code>NextMethod()</code> não é encerrado após finalizado a chamado do método herdado, como ocorre com <code>UseMethod()</code>;</li>
<li>A chamada <code>NextMethod()</code> é importante em algumas situações para evitar um <em>loop</em> infinito.</li>
</ol>
<p>Apresentaremos a seguir, um código para exemplificar esses pontos. E um código seguinte será específico para o último ponto.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Generico</span>
<span class='va'>fgenerica</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>UseMethod</a></span><span class='op'>(</span><span class='st'>"fgenerica"</span><span class='op'>)</span>
<span class='co'># Metodo 1</span>
<span class='va'>fgenerica.clas1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>z</span> <span class='op'>=</span> <span class='fu'>faux</span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>3</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>5</span>
  <span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></span><span class='op'>(</span>generic <span class='op'>=</span> <span class='va'>.Generic</span>, object <span class='op'>=</span> <span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"Passei pelo metodo 1"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Metodo 2</span>
<span class='va'>fgenerica.clas2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"Chegando no metodo 2, consigo imprimir x:"</span>, <span class='va'>x</span>, <span class='st'>"e y:"</span>, <span class='va'>y</span>, <span class='st'>"\n"</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"Existe classe em x? "</span>, <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"class"</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"\n"</span><span class='op'>)</span>
  
<span class='op'>}</span>
<span class='co'>############</span>
<span class='co'># Avaliacao:</span>
<span class='co'># Chamada do generico com objeto  de classe: clas1 e clas2</span>
<span class='fu'>fgenerica</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fl'>2</span>, class <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"clas1"</span>, <span class='st'>"clas2"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Chegando no metodo 2, consigo imprimir x: 3 e y: 5 
NULL
Existe classe em x?  
Passei pelo metodo 1</code></pre>
</div>
<p>Observemos no momento da chamada <code>NextMethod()</code> no método <code>fgenerica.clas1()</code> que o objeto do primeiro argumento <code>x</code> do genérico foi alterado [(1), (2) e (3)]. Inicialmente tinha o valor <code>2</code> com atributo <code>class</code>, porém no ambiente de execução do método <code>fgenerica.clas1()</code>, um objeto associado ao mesmo nome <code>x &lt;- 3</code> foi criado e passado para <code>NextMethod()</code>. Nesse caso, esse novo objeto não apresenta mais o atributo <code>class</code> (Observe a saída: <code>Existe classe em x?  NULL</code>), e desse modo é repassado para o método herdado, porém observemos que o fato de não ter o atributo <code>class</code> não prejudicou nas escolhas dos métodos (3).</p>
<p>Ainda no método <code>fgenerica.clas1()</code> surge um argumento <code>z</code> que apresenta uma função <code>faux()</code> não existente, isso é a característica de avaliação preguiçosa dos argumentos por parte das funções (4), isso significa, que enquanto esse argumento não for chamado internamente, ele não será avaliado. E isso pode ser verificado, pois o genérico retorna o resultado esperado, sem mensagem de erros.</p>
<p>Um outro ponto importante é o objeto <code>y</code> definido no corpo do método <code>fgenerica.clas1()</code>, que não definido como seu argumento, mas sim como argumento na chamada <code>NextMethod()</code>, do qual pode ser repassada para o método herdado (6). Isso foi possível também porque <code>y</code> também entrou como argumento para o método <code>fgenerica.clas2()</code>.</p>
<p>Diferentemente de <code>UseMethod()</code>, a chamada <code>NextMethod()</code> não encerra o ambiente de chamada (7). Isso pode ser verificado com o resultado do genérico imprimindo <code>Passei pelo metodo 1</code>, isto é, o genérico despacha em <code>fgenerica.clas1()</code> que herda o método <code>fgenerica.clas2()</code>, por meio de <code>NextMethod()</code>. Após o fechamento de <code>fgenerica.clas2()</code> e posteriormente da chamada <code>NextMethod()</code>, o ambiente de execução de <code>fgenerica.clas1()</code> continua a executar as suas instruções, do qual segue com a execução de <code>cat("Passei pelo metodo 1")</code>, e posteriormente ocorre o seu fechamento.</p>
<p>Por fim, a justificativa do último ponto, vamos apresentar uma aplicação muito importante que ocorre com a função primitiva genérica <code>[</code>. Por exemplo, se tivermos um vetor associado ao nome <code>x</code> com um atributo <code>class</code> e desejarmos o segundo elemento, isto é, <code>x[2]</code>. Este resultado não preserva a classe de <code>x</code>. Para isto, precisamos criar um método para esse genérico, apresentado a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Criando um objeto de classe 'cpf'</span>
<span class='va'>new_cpf</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='va'>x</span>, class <span class='op'>=</span> <span class='st'>"cpf"</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Metodo print para 'cpf'</span>
<span class='va'>print.cpf</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>3</span>, <span class='fl'>9</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>"*******"</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Criando e imprimindo x</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>new_cpf</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>12345678912</span>,
               <span class='fl'>78945612323</span>,
               <span class='fl'>98765432112</span><span class='op'>)</span><span class='op'>)</span>; <span class='va'>x</span>
</code></pre>
</div>
<pre><code>[1] &quot;12*******12&quot; &quot;78*******23&quot; &quot;98*******12&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Selecionando o segundo cpf</span>
<span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>[1] 78945612323</code></pre>
</div>
<p>Observamos nesse exemplo que a função primitiva <code>[</code> é um genérico mas que não tem o método para classe <em>cpf</em>. Nesse caso, precisamos criar um método para tal, apresentado três soluções a seguir.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Primeira solucao: Loop infinito</span>
<span class='va'>`[.cpf`</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>new_cpf</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>Error: avaliação aninhada demais; recursão infinita / options(expressions=)?</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Segunda solucao (menos eficiente pq cria copia de x)</span>
<span class='va'>`[.cpf`</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>unclass</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
  <span class='fu'>new_cpf</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>[1] &quot;78*******23&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Terceira solucao</span>
<span class='va'>`[.cpf`</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
  <span class='fu'>new_cpf</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>[1] &quot;78*******23&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Quarta solucao</span>
<span class='va'>`[.cpf`</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>new_cpf</span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/UseMethod.html'>NextMethod</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>[1] &quot;78*******23&quot;</code></pre>
</div>
<p>A primeira tentativa gera um <em>loop</em> infinito, porque ao criar o método <code>[.cpf()</code>, percebemos que internamente usamos a função primitiva genérica <code>[</code>, e como o objeto <code>x</code> tem o atributo <code>class</code> igual a <code>cpf</code>, este procurará novamente o método, e assim por diante. Uma segunda tentativa, resolve o problema, porém perdemos eficiência por fazer uma cópia do objeto <code>x</code>. E por fim, a terceira e quarta tentativas, são mais eficientes, sendo que a última usa a chamada <code>NextMethod()</code>. Essa chamada procura pelo próximo método que é a própria função primitiva, que ao ser executada retorna o resultado, e este entra como um argumento da função <code>new_cpf()</code>. Então, o ocorre a chamada <code>new_cpf()</code> que retorna novamente um objeto de classe <em>cpf</em>.</p>
<h4 id="mecanismo-de-herança">Mecanismo de herança</h4>
<!-- ### Estratégias para o sistema S3 {#estrategiaS3} -->
<!-- https://adv-r.hadley.nz/s3.html#s3-constructor -->
<!-- https://adv-r.hadley.nz/s3.html#validators -->
<!-- https://adv-r.hadley.nz/s3.html#helpers -->
<!-- http://adv-r.had.co.nz/S3.html#undefined -->
<!-- Constutor, validador e ajudante.... -->
<!-- ### Estilos de objetos POO S3 {#est_obj_poo_s3} -->
<!-- https://adv-r.hadley.nz/s3.html#object-styles -->
<h1 id="aprof-objetos">Entendendo um pouco mais sobre objetos</h1>
<!--
Introdução aos objetos:
  - Atômicos: objetos que não podem se conter
  - Recursivos: Objetos que podem conter objetos de mesmo tipo
  - Ver a função is.atomic() ou is.recursive()
<!-- require(stats) -->
<!-- is.a.r <- function(x) c(is.atomic(x), is.recursive(x)) -->
<!-- is.a.r(c(a = 1, b = 3)) # TRUE FALSE -->
<!-- is.a.r(list())          # FALSE TRUE - a list is a list -->
<!-- is.a.r(list(2))         # FALSE TRUE -->
<!-- is.a.r(lm)              # FALSE TRUE -->
<!-- is.a.r(y ~ x)           # FALSE TRUE -->
<!-- is.a.r(expression(x+1)) # FALSE TRUE -->
<!-- is.a.r(quote(exp))      # FALSE FALSE -->
<p>–&gt;</p>
<!--
- Aprofundar e detalhar a parte de objetos de modo geral, não restringindo apenas aos vetores
- Nos vetores de modo caractere, trabalhar bem sua utilização; ver o material da ecologia da USP
-->
<!-- Usar o manual https://cran.r-project.org/doc/manuals/r-release/R-lang.html para seguir a todos os tipos de objetos -->
<!-- # Objetos -->
<!-- ## Quadro de dados -->
<!-- - data.frames() -->
<!-- - tibble::tibble() -->
<h1 id="projetos-no-rstudio">Projetos no RStudio</h1>
<h1 id="projetos-r-no-github">Projetos R no Github</h1>
<h2 id="manipulando-vetores-de-modo-character">Manipulando vetores de modo <code>character</code></h2>
<!-- https://www.gastonsanchez.com/r4strings/ -->
<!-- https://gomesfellipe.github.io/post/2017-12-17-string/string/ -->
<!-- http://www.botanicaamazonica.wiki.br/labotam/doku.php?id=bot89:precurso:1textfun:inicio -->
<!-- https://bookdown.org/davi_moreira/txt4cs/stringR.html -->
<h3 id="pacote-tidytext">pacote tidytext</h3>
<!-- https://juliasilge.com/blog/learn-tidytext-learnr/ -->
<!-- https://juliasilge.shinyapps.io/learntidytext/ -->
<h2 id="objetos-modo-raw">Objetos modo <code>raw</code></h2>
<h2 id="objetos-modo-complex">Objetos modo <code>complex</code></h2>
<h2 id="outro-tipo-de-estrutura-de-dados-tibble">Outro tipo de estrutura de dados <code>tibble</code></h2>
<!-- tibble::tibble() -->
<h2 id="manipulações-com-objetos">Manipulações com objetos</h2>
<h2 id="cópias-de-objetos">Cópias de objetos</h2>
<h1 id="programação-funcional">Programação funcional</h1>
<h2 id="funções-primitivas">Funções primitivas</h2>
<!-- Usar a referencia "Software for data analysis - programming with R", 2008 - @chambers2008 -->
<!-- Algumas funções no `R` (objetos `R`) não apresentam a estrutura básica convencional de uma função no ambiente, como argumento, corpo da função e ambiente. Isto porque, essas funções foram implementadas principalemente em linguagem `C`, não em linguagem `R`, que chamamos de funções primitivas. Essas funções são encontradas apenas no pacote `base`, e sua grande vantagem é o seu desempenho, devido a sua implementação ter sido desenvolvida em linguagem de baixo nível. -->
<!-- Caso imprima uma dessas funções para visualizar a estrutura interna do código, será recebido no console, apenas a chamada de função `.Primitive`. Vejamos um exemplo, -->
<!-- ```{r echo=TRUE, include=TRUE} -->
<!-- # Operador unário "soma" (Funcao primitiva: tipo "builtin") -->
<!-- `+` -->
<!-- ``` -->
<!-- Desse modo, por meio da implementação realizada por Chambers(p.463-465; p.477-479(PDF)), vamos criar uma rotina para ser possível verificar quais as funções primitivas do pacote `base`, -->
<!-- As diferenças entre as funções `buitin` e `special` são ... p.465 (PDF, p.479) -->
<!-- Funções -->
<!-- Os objetos de modo `function`, isto é, uma função, são objetos de primeira classe porque se comportam como qualquer outra estrutura de dados na linguagem [R](http://r-project.org/){target='_blank'}, como atribuir nomes associados a esses objetos, passá-los como argumentos para outras funções, inserir dentro de funções, e até mesmo retorná-lo como resultado de funções. Vejamos, -->
<!-- apresentar formas de se criar operadores binários especiais -->
<!-- - Olhar escopo de variaveis seção 3.5: -->
<!-- https://cran.r-project.org/doc/manuals/R-lang.html#Global-environment -->
<!-- https://cran.r-project.org/doc/manuals/R-lang.html#Function-objects -->
<!-- Falar sobre controle de fluxos usando paralelização -->
<!-- - iterators -->
<!-- - foreach -->
<!-- - MonteCarlo -->
<!-- Ref: R in a nutshel, -->
<!-- ### Evitando loops -->
<!-- ### Funções recursivas -->
<h2 id="função-operadores-binários-ou-unirios">Função operadores binários ou unirios</h2>
<h3 id="pacote-magritt---pipe---lê-se-paipe">pacote magritt -&gt; %&gt;% (pipe - lê-se paipe)</h3>
<!-- -   Minus, can be unary or binary -->
<!-- +   Plus, can be unary or binary -->
<!-- !   Unary not -->
<!-- ~   Tilde, used for model formulae, can be either unary or binary -->
<!-- ?   Help -->
<!-- :   Sequence, binary (in model formulae: interaction) -->
<!-- *   Multiplication, binary -->
<!-- /   Division, binary -->
<!-- ^   Exponentiation, binary -->
<!-- %x% Special binary operators, x can be replaced by any valid name -->
<!-- %%  Modulus, binary -->
<!-- %/% Integer divide, binary -->
<!-- %*% Matrix product, binary -->
<!-- %o% Outer product, binary -->
<!-- %x% Kronecker product, binary -->
<!-- %in%    Matching operator, binary (in model formulae: nesting) -->
<!-- <   Less than, binary -->
<!-- >   Greater than, binary -->
<!-- ==  Equal to, binary -->
<!-- >=  Greater than or equal to, binary -->
<!-- <=  Less than or equal to, binary -->
<!-- &   And, binary, vectorized -->
<!-- &&  And, binary, not vectorized -->
<!-- |   Or, binary, vectorized -->
<!-- ||  Or, binary, not vectorized -->
<!-- <-  Left assignment, binary -->
<!-- ->  Right assignment, binary -->
<!-- $   List subset, binary -->
<h2 id="vetorização-de-funções">Vetorização de funções</h2>
<!-- new_cpf <- function(x, p_valor_zero = FALSE) { -->
<!--   # Programacao defensiva -->
<!--   n <- nchar(x) -->
<!--   if (!is.numeric(x)) stop("Deve ser numérico!") -->
<!--   if (n == 11) { -->
<!--     cpf <- structure(x %/% 10^seq(n - 1,0) %% 10, -->
<!--                      class = "cpf") -->
<!--   } -->
<!--   if (n != 11) { -->
<!--     if (n == 10 & p_valor_zero == TRUE) { -->
<!--       cpf <- structure(x %/% 10^seq(n,0) %% 10, -->
<!--                        class = "cpf") -->
<!--     } else { -->
<!--       stop("Seu CPF nao tem 11 digitos") -->
<!--     }  -->
<!--   }  -->
<!--   return(cpf) -->
<!-- } -->
<!-- print.cpf <- function(x, ...) { -->
<!--   cpf <- paste(x, collapse = "") -->
<!--   substr(cpf, 3, 9) <- "*******" -->
<!--   print(cpf) -->
<!-- } -->
<!-- x <- new_cpf(05098523435, TRUE) -->
<h2 id="evitando-loops">Evitando loops</h2>
<h2 id="funções-recursivas">Funções recursivas</h2>
<h2 id="programação-defensiva">Programação defensiva</h2>
<h3 id="função-stop">Função <code>stop()</code></h3>
<h3 id="função-warning">Função <code>Warning</code></h3>
<!-- new_cpf <- function(x, p_valor_zero = FALSE) { -->
<!--   # Programacao defensiva -->
<!--   n <- nchar(x) -->
<!--   if (!is.numeric(x)) stop("Deve ser numérico!") -->
<!--   if (n == 11) { -->
<!--     cpf <- structure(x %/% 10^seq(n - 1,0) %% 10, -->
<!--                      class = "cpf") -->
<!--   } -->
<!--   if (n != 11) { -->
<!--     if (n == 10 & p_valor_zero == TRUE) { -->
<!--       cpf <- structure(x %/% 10^seq(n,0) %% 10, -->
<!--                        class = "cpf") -->
<!--     } else { -->
<!--       stop("Seu CPF nao tem 11 digitos") -->
<!--     }  -->
<!--   }  -->
<!--   return(cpf) -->
<!-- } -->
<!-- print.cpf <- function(x, ...) { -->
<!--   cpf <- paste(x, collapse = "") -->
<!--   substr(cpf, 3, 9) <- "*******" -->
<!--   print(cpf) -->
<!-- } -->
<!-- x <- new_cpf(05098523435, TRUE) -->
<h2 id="escopo-léxico">Escopo léxico</h2>
<h2 id="execução-preguiçosa">Execução preguiçosa</h2>
<!-- https://www.r-bloggers.com/2018/07/about-lazy-evaluation/ -->
<!-- https://colinfay.me/tidyeval-1/ -->
<!-- http://colinfay.me/r-language-definition/objects.html#promise-objects -->
<h2 id="controle-de-fluxos-usando-paralelização">Controle de fluxos usando paralelização</h2>
<!-- - iterators -->
<!-- - foreach -->
<h2 id="gráficos">Gráficos</h2>
<!--  - Dispositivo gráfico: -->
<!--         - ggplot -->
<!--         - tmap -->
<!--         - graficos interativos (animate):  -->
<!--            sites: https://mode.com/blog/r-data-visualization-packages/ -->
<!--            sites: https://towardsdatascience.com/animating-your-data-visualizations-like-a-boss-using-r-f94ae20843e3 -->
<h1 id="introdução-a-desenvolvimento-de-pacotes">Introdução a desenvolvimento de pacotes</h1>
<h1 id="ambientes">Ambientes</h1>
<h1 id="banco-de-dados-e-apis-sql">Banco de dados e APIs, SQL</h1>
<h1 id="criação-de-documentações-no-r">Criação de documentações no R</h1>
<h2 id="documentos-web-estatística-e-dinâmica">Documentos Web (estatística e dinâmica)</h2>
<h3 id="páginas-de-pacote-pkgdown">Páginas de pacote (pkgdown)</h3>
<h3 id="livros-bookdown">Livros (bookdown)</h3>
<h3 id="blogs-e-websites-distill-blogdown">Blogs e websites (distill, blogdown)</h3>
<h2 id="documentos-pdf-word-epub">Documentos (PDF, WORD, EPUB)</h2>
<h3 id="documentos-estatísticos">Documentos estatísticos</h3>
<h3 id="documentos-animados">Documentos animados</h3>
<h3 id="relatórios-dinâmicos">Relatórios dinâmicos</h3>
<!-- Curso R <http://bendeivide.github.io/cursor> -->
<!-- Módulo: Programação em R (Nível Intermediário) -->
<!-- Ementa: -->
<!-- 1. Caracterizando melhor a linguagem R -->
<!--   1.1. Linguagem interpretada -->
<!--   1.2. Escopo léxico -->
<!--   1.3. Programação Funcional -->
<!--   1.4. Programação Meta-paradigma -->
<!--   1.5. Programação dinâmica -->
<!-- 2. Projetos no RStudio -->
<!-- 3. Projetos R no GitHub -->
<!-- 4. Entendendo um pouco mais sobre objetos -->
<!--   4.1. Manipulando strings -->
<!--   4.2. Objeto 'tibble' -->
<!--   4.3. manipulações com objetos -->
<!--   4.4. Cópias de objetos -->
<!-- 5. Programação orientada a objetos -->
<!--   5.1. Classes e métodos -->
<!--   5.2. ... -->
<!-- 6. Programação Funcional -->
<!--   6.1. Operadores binários -->
<!--   6.2. Sintaxe da família de Pacotes Tidyverse -->
<!--   6.3 Evitando loops -->
<!--   6.4. Funções recursivas -->
<!--   6.5. Programação defensiva -->
<!--   6.6. Controle de fluxos usando paralelização -->
<!-- 7. Gráficos -->
<!-- 8. Introdução a desenvolvimento de pacotes -->
<!-- 9. Aprofundamento sobre ambientes -->
<!-- 10. Banco de dados -->
<!-- 11. Criação de documentações no R -->
<!--   11.1. Documentos Web -->
<!--     11.1.1 Páginas estatísticas -->
<!--     11.1.2. Páginas dinâmicas -->
<!--   11.2. Documentações de pacotes -->
<!--      11.2.1. Documentações de ajuda .Rd -->
<!--      11.2.2.  Página Web de pacotes    -->
<!--   11.3. Livros -->
<!--   11.4. Blogs e websites -->
<!--   11.5. Relatórios -->
<!--     11.5.1. Relatórios animados -->
<!--     11.5.2. Relatórios dinâmicos -->
<!--   11.6. Demais documentos (PDF, WORD, EPUB) -->
<div class="sourceCode" id="cb121"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-chambers2008" class="csl-entry" role="doc-biblioentry">
Chambers, John M. 2008. <em>Software for Data Analysis: Programming with <span>R</span></em>. Statistics and <span>C</span>omputing. New York: Springer.
</div>
<div id="ref-chambers2016" class="csl-entry" role="doc-biblioentry">
———. 2016. <em>Extending <span>R</span></em>. The <span>R</span> <span>S</span>eries. Boca Raton, Florida: Chapman; Hall/CRC.
</div>
<div id="ref-chambers1991" class="csl-entry" role="doc-biblioentry">
Chambers, John M., and Trevor J. Hastie. 1991. <em>Statistical Methods in <span>S</span></em>. London: Chapman &amp; Hall.
</div>
<div id="ref-chambers1993" class="csl-entry" role="doc-biblioentry">
———. 1993. <em>Statistical Models in <span>S</span></em>. London: Chapman &amp; Hall.
</div>
<div id="ref-hadley2019" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2019. <em>Advanced <span>R</span></em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://adv-r.hadley.nz/">https://adv-r.hadley.nz/</a>.
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Funções primitivas chamam as funções em linguagem <code>C</code>, <code>DispatchGroup()</code> ou <code>DispatchOrEval()</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Função similar <code>sprintf()</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Licença Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />Este trabalho está licenciado com uma Licença <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons - Atribuição-NãoComercial 4.0 Internacional</a>.</p>
<!-- hitwebcounter Code START -->
<p><a href="https://www.hitwebcounter.com" target="_blank"> <img src="https://hitwebcounter.com/counter/counter.php?page=7835102&style=0010&nbdigits=9&type=page&initCount=1000" title="Free Counter" Alt="web counter"   border="0" /></a></p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>

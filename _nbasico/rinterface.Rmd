```{r, echo=FALSE}
xaringanExtra::use_panelset()
```


# <i class="fas fa-sort-alpha-down"></i> Interfaces com outras linguagens {#rinterface}

Como afirmado no terceiro princício,

<blockquote>
<p>
- **Princípio da Interface**: Interfaces para outros programas são parte do `R`,
</p>
</blockquote>

na base do `r rlink` temos integrações prontas para implementar códigos em *C* e *FORTRAN*, como também outras linguagens. Por exemplo, na base do `r rlink` existe um pacote chamado `tcltk` que integra a linguagem *Tcl/Tk* para o `r rlink`. Esse pacote nos permite desenvolver interfaces gráficas para os nossos códigos.

Diversos outros pacotes, disponibilizados sob o `r cran` realizaram diversas outras linguagens, que elencamos alguns,

| Pacote      | Linguagem integrada |
|:------:     |:-------------------:|
|`tcltk`      | Linguagem *Tcl/Tk*  |
| [RGtk2](https://github.com/cran/RGtk2)     | Linguagem *Gtk+*    |
| [rJava](http://www.rforge.net/rJava/)     | Linguagem *Java*    |
| [rmarkdown](https://rmarkdown.rstudio.com/) | Linguagens *HTML*, *JavaScript*, *CSS*, *Markdown*, $\LaTeX$ |
|  [reticulate](https://rstudio.github.io/reticulate/) | Linguagem *Python* |
| [JuliaCall](https://non-contradiction.github.io/JuliaCall/index.html), [XRJulia](https://cran.r-project.org/web/packages/XRJulia/index.html) | Linguagem *Julia* |
| [Rcpp](http://www.rcpp.org/) | Linguagem *C++* |
| [gecoder](http://gecoder.org/) | Linguagem *Ruby*  |

Existe um aplicativo da web bem interessante que integra as linguagem *Julia*, *Python* e `r rlink`, chamado [Jupyter](https://jupyter.org/). Muitas outras interfaces são integradas ao `r rlink`. Ao longo do que formos pesquisando sobre mais pacotes, vamos atualizando a tabela.

Como motivação para esse momento, iremos realizar uma aplicação com as linguagens *Python*, *C++* e *Tcl/tk*, para verificarmos que essas integrações são fáceis de serem realizadas. Claro, em algumas outras situações, como a integração do código *C* para `r rlink` usando as funções `.C()` ou `.Call()` exigem um pouco mais de conhecimento. Contudo, no módulo Programação em R (Nível Avançado), iremos realizar algumas integrações com um abordagem mais profunda para algumas linguagens.


::: {.panelset}
::: {.panel}
## Implementação em *Python*

Vamos inicialmente instalar o pacote [reticulate](https://rstudio.github.io/reticulate/),

```{r, echo=TRUE, eval=FALSE, prompt=TRUE}
install.packages(reticulate)
```

Existem diversas formas de integração. Vamos pensar na forma mais básica, isto é, temos um [*script Python*](scripts/aula24/add.py), isto é, um arquivo com a extensão *.py*, e vamos carregá-lo no `r rlink`. O *script*, chamaremos de [add.py](scripts/aula24/add.py), que segue:

```{python, echo = TRUE, eval = FALSE}
def add(x, y):
  return x + y
```

Vamos agora chamar a função `add()` em um [*script R*](scripts/aula24/r-python.R):

```{r echo=TRUE, prompt=TRUE}
# Carregando o script add.py
reticulate::source_python('add.py') 
# Chamando a funcao add
add(5, 10)
```
:::
::: {.panel}
## Implementação em *C++*

Vamos instalar o pacote [Rcpp](http://www.rcpp.org/),

```{r, echo=TRUE, eval=FALSE, prompt=TRUE}
install.packages(Rcpp)
```

Vamos realizar a mesma aplicação feita em *Python*, que segue o [*script C++*](scripts/aula24/add.cpp), com extensão *.cpp*,

```{Rcpp, echo=TRUE, eval=FALSE}
#include <Rcpp.h>
using namespace Rcpp;

// [[Rcpp::export]]
int add(int x, int y) {
  return x + y;
}
```

Vamos agora chamar a função `add()` em um [*script R*](scripts/aula24/r-rcpp.R):

```{r, echo=TRUE, prompt=TRUE}
# Carregando o script add.cpp
Rcpp::sourceCpp("add.cpp")
# Chamando a funcao add
add(5, 10)
```
:::

::: {.panel}
## Implementação em TclTk

Nesse caso, não precisaremos instalar pacotes, pois o pacote `tcltk` é da Base do `r rlink`. Ao invés, anexe-o no caminho de busca, use `library(tcltk)`. Iremos implementar uma interface gráfica contendo uma janela com entradas de dois números e um botão para calcular a soma. Segue o [*script*](scripts/aula24/r-tcltk.R),

```{r tcltk, echo=TRUE, eval=FALSE, prompt=TRUE}
# Anexando o pacote
library(tcltk)

# Janela principal
main <- tktoplevel(width = 400, height = 300)
tkpack.propagate(main, FALSE)

# Texto inicial
tkpack(tklabel(main, text = "Soma de dois números inteiros"))

# Quadro 1
tkpack(q1 <- tkframe(main), side = "top")
tkpack(tklabel(q1, text = "Insira o primeiro número: ", padx = 3), side = "left", anchor = "e")


# Entrada 1
var1 <- tclVar("Insira um número inteiro")
tkpack(entry1 <- tkentry(q1, textvariable = var1, width = 25), side = "left", anchor = "ne")

# Quadro 2
tkpack(q2 <- tkframe(main), side = "top")
tkpack(tklabel(q2, text = "Insira o segundo número: ", padx = 3), side = "left", anchor = "e")

# Entrada 2
var2 <- tclVar("Insira um número inteiro")
tkpack(entry2 <- tkentry(q2, textvariable = var2, width = 25), side = "left", anchor = "ne")
# Botao 
tkpack(botao <- tkbutton(main, text = "Somar dois números"), side = "top")
# Funcao auxiliar
f1 <- function(...) {
  if ((is.na(as.numeric(tclvalue(var1))) | is.na(as.numeric(tclvalue(var2))))) {
    tkpack(tklabel(main, text = "Insira Valores numéricos!"), side = "top")
  } else {
    res <- as.numeric(tclvalue(var1)) + as.numeric(tclvalue(var2))
    tkpack(tklabel(main, text = paste("A soma é igual a ", res)), side = "top")
  }
} 
# Acao ao Botao
tkbind(botao, "<ButtonRelease>", f1)
```

O vídeo abaixo apresenta o resultado da interface.

<iframe width="560" height="315" src="https://www.youtube.com/embed/u1AQoCEfOF0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
:::

:::

Existem outras formas de chamar as rotinas em *Python*, *C++* e *Tcl/Tk* no `r rlink`, implementadas nos pacotes [reticulate](https://rstudio.github.io/reticulate/), [Rcpp](http://www.rcpp.org/) e *tcltk*, respecitvamente. Contudo, iremos apresentá-los no módulo [Programação em R (Nível Avançado)](navancado.html), bem como a integração de outras linguagens.


